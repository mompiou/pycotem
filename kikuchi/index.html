
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-8.0.3">
    
    
      
        <title>Kikuchi - pycotem</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.62128196.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.9204c3b2.min.css">
        
          
          
          <meta name="theme-color" content="#7e56c2">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Asap:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font:"Asap";--md-code-font:""}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>function __md_scope(e,t,_){return new URL(_||(t===localStorage?"..":".."),location).pathname+"."+e}function __md_get(e,t=localStorage,_){return JSON.parse(t.getItem(__md_scope(e,t,_)))}function __md_set(e,t,_=localStorage,o){try{_.setItem(__md_scope(e,_,o),JSON.stringify(t))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="pycotem" class="md-header__button md-logo" aria-label="pycotem" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pycotem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Kikuchi
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/mompiou/pycotem" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    mompiou/pycotem
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="pycotem" class="md-nav__button md-logo" aria-label="pycotem" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
<!--    pycotem-->
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mompiou/pycotem" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    mompiou/pycotem
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../diffraction/" class="md-nav__link">
        Diffraction
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Kikuchi
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Kikuchi
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indexing-kikuchi-bands" class="md-nav__link">
    Indexing Kikuchi bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calibration" class="md-nav__link">
    Calibration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#orientation" class="md-nav__link">
    Orientation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure" class="md-nav__link">
    Procedure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refining-the-results" class="md-nav__link">
    Refining the results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tilt-conditions" class="md-nav__link">
    Tilt conditions
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../stereoproj/" class="md-nav__link">
        StereoProj
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../interface/" class="md-nav__link">
        Interface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../misorientation/" class="md-nav__link">
        Misorientation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ressources/" class="md-nav__link">
        Further ressources
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contribute/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indexing-kikuchi-bands" class="md-nav__link">
    Indexing Kikuchi bands
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#calibration" class="md-nav__link">
    Calibration
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#orientation" class="md-nav__link">
    Orientation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure" class="md-nav__link">
    Procedure
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#refining-the-results" class="md-nav__link">
    Refining the results
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tilt-conditions" class="md-nav__link">
    Tilt conditions
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <h1>Kikuchi</h1>

<p><code>kikuchi</code> allows to determine orientation from a kikuchi pattern.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Kikuchi lines result from inelastic scattering in a sufficiently thick crystal. Considering an electron beam entering the crystal, electron are scattered in different directions, but more likely in the forward direction. The electrons that are in Bragg conditions, i.e. forming an angle <span class="arithmatex"><span class="MathJax_Preview">\pm \theta_B</span><script type="math/tex">\pm \theta_B</script></span>, with an atomic plane will eventually be diffracted. Their wave vectors <span class="arithmatex"><span class="MathJax_Preview">\vec{k}_0</span><script type="math/tex">\vec{k}_0</script></span>, <span class="arithmatex"><span class="MathJax_Preview">\vec{k}'_0</span><script type="math/tex">\vec{k}'_0</script></span> are distributed in two <em>Kossel cones</em> of aperture <span class="arithmatex"><span class="MathJax_Preview">90-\theta_B</span><script type="math/tex">90-\theta_B</script></span>,  around the plane normal, corresponding to the diffraction vectors <span class="arithmatex"><span class="MathJax_Preview">\vec{g}</span><script type="math/tex">\vec{g}</script></span> or <span class="arithmatex"><span class="MathJax_Preview">\vec{g}'=-\vec{g}</span><script type="math/tex">\vec{g}'=-\vec{g}</script></span>. The diffracted beam with wave vectors <span class="arithmatex"><span class="MathJax_Preview">\vec{k}_g</span><script type="math/tex">\vec{k}_g</script></span> and <span class="arithmatex"><span class="MathJax_Preview">\vec{k}'_g</span><script type="math/tex">\vec{k}'_g</script></span>, which are also distributed on the cones, intersect the observation screen and form lines, as <span class="arithmatex"><span class="MathJax_Preview">\theta_B</span><script type="math/tex">\theta_B</script></span> is small. Because the inelastic scattering is more intense in the forward direction, the diffracted beam <span class="arithmatex"><span class="MathJax_Preview">\vec{k}_g</span><script type="math/tex">\vec{k}_g</script></span> gives rise to a line with a higher intensity, i.e. an excess line. On the contrary, <span class="arithmatex"><span class="MathJax_Preview">\vec{k}'_g</span><script type="math/tex">\vec{k}'_g</script></span> corresponds to a defected line.</p>
<p><img alt="" src="../images/kikuchi-lines.png" /></p>
<p>The defected and excess lines are separated by the angle <span class="arithmatex"><span class="MathJax_Preview">2\theta_B</span><script type="math/tex">2\theta_B</script></span> which in the observation plane corresponds to a distance</p>
<div class="arithmatex">
<div class="MathJax_Preview">
r \approx L\theta_B = \frac{\lambda L}{d} 
</div>
<script type="math/tex; mode=display">
r \approx L\theta_B = \frac{\lambda L}{d} 
</script>
</div>
<p>where <span class="arithmatex"><span class="MathJax_Preview">L</span><script type="math/tex">L</script></span> is the camera length, i.e. the effective distance between the back focal plane of the objective lens and the observation screen, <span class="arithmatex"><span class="MathJax_Preview">\lambda</span><script type="math/tex">\lambda</script></span> the electron wavelength, and <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> the interplanar distance related to the <span class="arithmatex"><span class="MathJax_Preview">(h,k,l)</span><script type="math/tex">(h,k,l)</script></span> plane.</p>
<p>Thus, the nature of the Kikuchi bands can be determined, knowing the calibration parameter <span class="arithmatex"><span class="MathJax_Preview">L</span><script type="math/tex">L</script></span>, the electron wavelength, which depends on the acceleration voltage and the crystal structure.</p>
<h2 id="indexing-kikuchi-bands">Indexing Kikuchi bands<a class="headerlink" href="#indexing-kikuchi-bands" title="Permanent link">&para;</a></h2>
<p><span class="arithmatex"><span class="MathJax_Preview">(h,k,l)</span><script type="math/tex">(h,k,l)</script></span> bands can be retrieved, knowing the crystal structure. It can be imported from the <code>structure</code> menu. This menu can be populated by adding structures in the <code>structure.txt</code> files following the template:</p>
<div class="highlight"><pre><span></span><code>Name a(A) b(A) c(A) alpha beta gamma space group
</code></pre></div>
<p>The space group is defined in the <code>space_group.txt</code> file and with the  <code>scattering.txt</code> file (see <a href="../diffraction/">diffraction</a> for more details).</p>
<p>Alternatively, the structure can be set by filling the <span class="arithmatex"><span class="MathJax_Preview">a,b,c</span><script type="math/tex">a,b,c</script></span>  and <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>, <span class="arithmatex"><span class="MathJax_Preview">\beta</span><script type="math/tex">\beta</script></span>, <span class="arithmatex"><span class="MathJax_Preview">\gamma</span><script type="math/tex">\gamma</script></span> fields.</p>
<h2 id="calibration">Calibration<a class="headerlink" href="#calibration" title="Permanent link">&para;</a></h2>
<p>The Kikuchi pattern needs to be calibrated on the microscope used but the calibration can be adjusted afterward. </p>
<p>The calibrations are set in the <code>calibration.txt</code> file following the scheme:</p>
<div class="highlight"><pre><span></span><code>Microscope_name voltage camera length binning r.d
...
</code></pre></div>
<h2 id="orientation">Orientation<a class="headerlink" href="#orientation" title="Permanent link">&para;</a></h2>
<p>Orientation of the crystal can be retrieved from the analysis of the band configuration in an approach similar to the one described in <a href="../diffraction/">diffraction</a>.</p>
<p>The figure below shows the relation between the Kikuchi bands that can be defined by their normal vector <span class="arithmatex"><span class="MathJax_Preview">\vec{v}_{i}</span><script type="math/tex">\vec{v}_{i}</script></span> and their projection <span class="arithmatex"><span class="MathJax_Preview">\vec{v}_{pi}</span><script type="math/tex">\vec{v}_{pi}</script></span> in the observation plane normal to vector <span class="arithmatex"><span class="MathJax_Preview">\vec{z}_P</span><script type="math/tex">\vec{z}_P</script></span>, i.e. the reverse of the electron beam direction <sup id="fnref:inversion"><a class="footnote-ref" href="#fn:inversion">1</a></sup>.</p>
<p>From the projected vector, the normal band vector in the viewing screen coordinate system <span class="arithmatex"><span class="MathJax_Preview">(x,y,z)_P</span><script type="math/tex">(x,y,z)_P</script></span> can be deduced knowing the camera length <span class="arithmatex"><span class="MathJax_Preview">L=\|\vec{OP}\|</span><script type="math/tex">L=\|\vec{OP}\|</script></span>:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\vec{v}_i=[x_i,y_i,z_i]^T=\vec{v}_{pi}+[0,0,\|\vec{v}_{pi}\|^2/L]^T
</div>
<script type="math/tex; mode=display">
\vec{v}_i=[x_i,y_i,z_i]^T=\vec{v}_{pi}+[0,0,\|\vec{v}_{pi}\|^2/L]^T
</script>
</div>
<p><img alt="" src="../images/kikuchi-orientation.png" /></p>
<p>Considering N bands, the orientation can be defined by: </p>
<div class="arithmatex">
<div class="MathJax_Preview">
G_C A=G_M
</div>
<script type="math/tex; mode=display">
G_C A=G_M
</script>
</div>
<p>with</p>
<div class="arithmatex">
<div class="MathJax_Preview">
G_C=D^\ast \begin{pmatrix} 
h_1 &amp; k_1 &amp; l_1\\
&amp; ... &amp; \\
h_N &amp; k_N &amp; l_N     
\end{pmatrix}
</div>
<script type="math/tex; mode=display">
G_C=D^\ast \begin{pmatrix} 
h_1 & k_1 & l_1\\
& ... & \\
h_N & k_N & l_N     
\end{pmatrix}
</script>
</div>
<p>the g-vectors in the crystal coordinates and
<span class="arithmatex"><span class="MathJax_Preview">D^\ast</span><script type="math/tex">D^\ast</script></span> is defined <a href="../stereoproj/#setting-up-the-crystal">here</a>, and: </p>
<div class="arithmatex">
<div class="MathJax_Preview"> 
G_M=\begin{pmatrix} 
x_1 &amp; y_1 &amp; z_1\\
&amp; ... &amp; \\
x_N &amp; y_N &amp; z_N     
\end{pmatrix}
</div>
<script type="math/tex; mode=display"> 
G_M=\begin{pmatrix} 
x_1 & y_1 & z_1\\
& ... & \\
x_N & y_N & z_N     
\end{pmatrix}
</script>
</div>
<p>As the above equation defines the crystal orientation, <span class="arithmatex"><span class="MathJax_Preview">A</span><script type="math/tex">A</script></span> should be a rotation matrix. The closest Euler rotation matrix <span class="arithmatex"><span class="MathJax_Preview">R</span><script type="math/tex">R</script></span> can be found with the approach proposed by Mackenzie using singular value decomposition:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
U,S,V^T=svd(G_C^TG_M) \\
R=V U^T
</div>
<script type="math/tex; mode=display">
U,S,V^T=svd(G_C^TG_M) \\
R=V U^T
</script>
</div>
<p>The Euler angles are retrieved from the <span class="arithmatex"><span class="MathJax_Preview">R</span><script type="math/tex">R</script></span> matrix:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\varphi_1 = \arctan (R_{02}, R_{12}) \\
\phi = \arccos(R_{22}) \\
\varphi_2 = \arctan (R_{20},R_{21})
</div>
<script type="math/tex; mode=display">
\varphi_1 = \arctan (R_{02}, R_{12}) \\
\phi = \arccos(R_{22}) \\
\varphi_2 = \arctan (R_{20},R_{21})
</script>
</div>
<p>In <a href="../diffraction/">diffraction</a>, the g-vectors in crystal coordinates are determined step by step by calculating the angles between the vectors, and letting the user to choose. 
Kikuchi bands usually have higher indices so that it is more difficult to guess the right indices. 
Here we choose to compare the relative measured angles of g-vectors <span class="arithmatex"><span class="MathJax_Preview">\theta_{ij}=\angle{(\vec{g}_i,\vec{g}_j)}</span><script type="math/tex">\theta_{ij}=\angle{(\vec{g}_i,\vec{g}_j)}</script></span> with a lookup table compiling the angles <span class="arithmatex"><span class="MathJax_Preview">\theta'_{ij}=\angle{((h_i,k_i,l_i),(h_j,k_j,l_j))}</span><script type="math/tex">\theta'_{ij}=\angle{((h_i,k_i,l_i),(h_j,k_j,l_j))}</script></span>. A consistent set of  g-vectors is obtained if all the angle differences <span class="arithmatex"><span class="MathJax_Preview">\left|\theta_{ij}-\theta'_{ij}\right|</span><script type="math/tex">\left|\theta_{ij}-\theta'_{ij}\right|</script></span> is less than a tolerance angle <span class="arithmatex"><span class="MathJax_Preview">\epsilon</span><script type="math/tex">\epsilon</script></span> that can be chosen.  </p>
<h2 id="interface">Interface<a class="headerlink" href="#interface" title="Permanent link">&para;</a></h2>
<p>The interface is composed of  a top bar menu, a plotting area to display Kikuchi pattern and a setting/results panel.</p>
<p><img alt="" src="../images/kikuchi-interface.png" /></p>
<h2 id="procedure">Procedure<a class="headerlink" href="#procedure" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p>Enter the crystal structure and space group.</p>
</li>
<li>
<p>Select the maximum indices for band identification.</p>
</li>
<li>
<p>Enter the microscope calibration.</p>
</li>
<li>
<p>Open a pattern.</p>
</li>
<li>
<p>Click on the pattern center and press <code>Add center</code>. Position of the center appears in the box.</p>
</li>
<li>
<p>To highlight the bands, the <code>brightness</code> can be adjusted.</p>
</li>
<li>
<p>Select a band by clicking three times. The first two points define the direction along one line. The third point should be on the second parallel line. Then, both the d-spacing and the projected g-vector can be retrieved. A better accuracy can be achieved if the direction is measured with two extreme points along the line. Zooming in the pattern can also be helpful.</p>
</li>
<li>
<p>Press <code>Add bands</code>. The band number and the corresponding (projected) d-spacing dp (in px) appears in the <strong>Bands</strong> box. Bands can be removed by pressing the <code>Remove band</code> button.</p>
</li>
<li>
<p>Clear the points and view (if zoomed in) with the <code>Reset points</code> and <code>Reset view</code> buttons.</p>
</li>
<li>
<p>Repeat the operation at least twice and no more than 6 times (2 to 6 bands to identify). </p>
</li>
<li>
<p>Choose a tolerance angle <span class="arithmatex"><span class="MathJax_Preview">\epsilon</span><script type="math/tex">\epsilon</script></span> less than 3 degrees. 1 by default.</p>
</li>
<li>
<p>Plot the bands to verify the measured bands.</p>
</li>
<li>
<p>Press the <code>Run</code> button to display solutions in the <strong>Results</strong> box. If no solutions, remove the bands and try a more accurate point and click and/or increase the tolerance angle.</p>
</li>
<li>
<p>By selecting the different sets of data and by clicking on the <code>Show bands</code> button, the theoretical bands are plotted in overlay. The results are shown according the scheme:</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>g: [h1,k1,l1],....,[hN,kN,lN]
Euler angles phi1, phi, phi2
dev_angle, dev_width
...
</code></pre></div>
<p>The <code>dev_angle</code> value corresponds to the mean misorientation: </p>
<div class="arithmatex">
<div class="MathJax_Preview">
\langle \Delta \theta \rangle = \frac{1}{N}{\sum_i^N \left| \arccos(R \vec{g}_{h_i k_i l_i} \cdot [x_i,y_i,z_i]^T) \right |}
</div>
<script type="math/tex; mode=display">
\langle \Delta \theta \rangle = \frac{1}{N}{\sum_i^N \left| \arccos(R \vec{g}_{h_i k_i l_i} \cdot [x_i,y_i,z_i]^T) \right |}
</script>
</div>
<p>The <code>dev_width</code> value corresponds to the mean deviation on the d spacing values (in percents).</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\langle \Delta d \rangle= \frac{1}{N} {\sum_i^N  \frac{\left|d_{h_i k_i l_i} - d_i \right|}{d_{h_i k_i l_i}} }
</div>
<script type="math/tex; mode=display">
\langle \Delta d \rangle= \frac{1}{N} {\sum_i^N  \frac{\left|d_{h_i k_i l_i} - d_i \right|}{d_{h_i k_i l_i}} }
</script>
</div>
<p><img alt="" src="../images/kikuchi-procedure.png" /></p>
<p>These two values should be as minimum as possible. Usually a good fit can be obtained with <span class="arithmatex"><span class="MathJax_Preview">\langle \Delta \theta \rangle</span><script type="math/tex">\langle \Delta \theta \rangle</script></span> of the order of 0.2 degrees and <span class="arithmatex"><span class="MathJax_Preview">\langle \Delta d \rangle</span><script type="math/tex">\langle \Delta d \rangle</script></span> of the order of few percents.</p>
<h2 id="refining-the-results">Refining the results<a class="headerlink" href="#refining-the-results" title="Permanent link">&para;</a></h2>
<p>Refining the results can be made from the <code>Refine</code> menu:</p>
<ul>
<li>
<p>Manual rotations along <span class="arithmatex"><span class="MathJax_Preview">x</span><script type="math/tex">x</script></span>, <span class="arithmatex"><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span> and <span class="arithmatex"><span class="MathJax_Preview">z</span><script type="math/tex">z</script></span> axes can be performed to judge the qualitative agreement between the pattern and the theoretical lines.</p>
</li>
<li>
<p>The calibration and acceleration voltage can also be adjusted. By clicking the <code>update</code> button, the solutions are re-calculated using the new sets of values. A better fit can be judged by inspecting how <span class="arithmatex"><span class="MathJax_Preview">\langle \Delta \theta \rangle</span><script type="math/tex">\langle \Delta \theta \rangle</script></span> and <span class="arithmatex"><span class="MathJax_Preview">\langle \Delta d \rangle</span><script type="math/tex">\langle \Delta d \rangle</script></span> are minimized.</p>
</li>
<li>
<p>The updated Euler angles can be read at the bottom of the refine window.</p>
</li>
</ul>
<p><img alt="" src="../images/kikuchi-refine.png" /></p>
<h2 id="tilt-conditions">Tilt conditions<a class="headerlink" href="#tilt-conditions" title="Permanent link">&para;</a></h2>
<p>By default the orientation determined corresponds to the situation of the holder at zero tilt the Euler angle being given in the <span class="arithmatex"><span class="MathJax_Preview">(x,y,z)_P</span><script type="math/tex">(x,y,z)_P</script></span> coordinate system. To retrieve the Euler angle at zero tilt from a tilted sample, the <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>, <span class="arithmatex"><span class="MathJax_Preview">\beta</span><script type="math/tex">\beta</script></span>, <span class="arithmatex"><span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script></span> tilt angles and the angle <span class="arithmatex"><span class="MathJax_Preview">\xi</span><script type="math/tex">\xi</script></span> between the <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>-tilt axis and the y-axis should be indicated as the Euler rotation matrix at zero tilt <span class="arithmatex"><span class="MathJax_Preview">R_0</span><script type="math/tex">R_0</script></span> is deduced from the rotation matrix <span class="arithmatex"><span class="MathJax_Preview">R_t</span><script type="math/tex">R_t</script></span> obtained by the relation:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
R_0=R_z(-\xi)R_y(-\alpha)R_x(-\beta)R_z(\xi)R_t
</div>
<script type="math/tex; mode=display">
R_0=R_z(-\xi)R_y(-\alpha)R_x(-\beta)R_z(\xi)R_t
</script>
</div>
<ul>
<li>Fill the filed in the Tilt conditions window accessed from the <code>Tool</code></li>
<li>Press <code>Run</code> in the main window or <code>Update</code> in the Refine window to update the Euler angles.</li>
</ul>
<p><img alt="" src="../images/kikuchi-tilt.png" /></p>
<div class="footnote">
<hr />
<ol>
<li id="fn:inversion">
<p>Note that considering vectors pointing downward in the electron beam direction lead to similar results except the pattern is inverted. This inversion is taken into account here.&#160;<a class="footnote-backref" href="#fnref:inversion" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
<!--  -->
<!--    <nav class="md-footer__inner md-grid" aria-label="Footer">-->
<!--      -->
<!--        -->
<!--        <a href="../diffraction/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Diffraction" rel="prev">-->
<!--          <div class="md-footer__button md-icon">-->
<!--            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>-->
<!--          </div>-->
<!--          <div class="md-footer__title">-->
<!--            <div class="md-ellipsis">-->
<!--              <span class="md-footer__direction">-->
<!--                Previous-->
<!--              </span>-->
<!--              Diffraction-->
<!--            </div>-->
<!--          </div>-->
<!--        </a>-->
<!--      -->
<!--      -->
<!--        -->
<!--        <a href="../stereoproj/" class="md-footer__link md-footer__link--next" aria-label="Next: StereoProj" rel="next">-->
<!--          <div class="md-footer__title">-->
<!--            <div class="md-ellipsis">-->
<!--              <span class="md-footer__direction">-->
<!--                Next-->
<!--              </span>-->
<!--              StereoProj-->
<!--            </div>-->
<!--          </div>-->
<!--          <div class="md-footer__button md-icon">-->
<!--            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>-->
<!--          </div>-->
<!--        </a>-->
<!--      -->
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Contact  &nbsp <A HREF="mailto:mompiou@cemes.fr"><img src="https://mompiou.github.io/pycotem/images/envelope.png"  ></A>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.01824240.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.e0abf5b0.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>