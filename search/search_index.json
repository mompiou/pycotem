{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["trimmer","stopWordFilter"]},"docs":[{"location":"","title":"pycotem","text":"<p>pycotem is a python package for working with crystal orientations in transmission electron microscopy. It provides 6 GUI tools to:</p> <ul> <li> <p>determine orientation from diffraction patterns: diffraction</p> </li> <li> <p>determine orientation from Kikuchi patterns: kikuchi</p> </li> <li> <p>work with stereographic projections: stereoproj</p> </li> <li> <p>determine interface normal and direction from images: interface</p> </li> <li> <p>determine orientation relationship and misorientation between two crystals: misorientation</p> </li> <li> <p>display crystal projection on a plane and draw dichromatic patterns: crystal</p> </li> </ul> <p></p>"},{"location":"contribute/","title":"About","text":"<p>Contributions, bug issues, requests and comments can be adressed directly or through pull-request on github.</p>"},{"location":"contribute/#cite","title":"Cite","text":"<p>Mompiou F, Xie R-X. \" pycotem: An open source toolbox for online crystal defect characterization from TEM imaging and diffraction \" . Journal of Microscopy. 2020; 1\u201314. doi</p>"},{"location":"contribute/#license","title":"License","text":"<p>This project is licensed under the GPL-3.0 License.</p>"},{"location":"crystal/","title":"Crystal","text":"<p><code>crystal</code> allows to display crystal projection on a plane and draw dichromatic patterns.</p>"},{"location":"crystal/#interface","title":"Interface","text":"<p>The interface is composed of  a top bar menu, a plotting area to display the projection and a setting panel.</p> <p></p>"},{"location":"crystal/#procedure","title":"Procedure","text":"<ul> <li> <p>Enter the Crystal Parameters, either from the input fields or from the structure menu</p> </li> <li> <p>Fill the <code>Plane</code> field and the <code>Size</code> of the crystal box (integer units of the lattice parameters).</p> </li> <li> <p>Enter the layers indices (<code>Layers numb.</code>) parallel to the projected plane according to the scheme n_0,n_1, n being the layer number.</p> </li> <li> <p>Press the <code>Calculate</code> button. You will be prompted to select the appropriate crystal structure. Text files such as <code>cfc.txt</code> describe the position of atoms in the unit cell. The format is: </p> </li> </ul> <pre><code>atom1 x1 y1 z1\n\n...\n\natomn xn yn zn\n\nv1x v1y v1z\n\n...\n\nvkx vky vkz\n</code></pre> <p>with <code>atomn</code> is nth atom in the cell at coordinate <code>xn, yn, zn</code> and <code>vkx,vky,vkz</code> is the kth translation vector defining all the positions of atoms in the cell.</p> <ul> <li> <p>Press the <code>Draw</code> button.</p> </li> <li> <p>Tick <code>Atom type</code> button to see the different atoms (label with different numbers)</p> </li> <li> <p>Tick <code>Atom position</code> button to see the coordinates</p> </li> </ul> <p></p> <p>Projection of 3 layers of the (1,1,1) plane in an Al crystal</p>"},{"location":"crystal/#layout","title":"Layout","text":"<ul> <li> <p>Change the <code>Marker size</code> and shape using the <code>Square/circle</code> button</p> </li> <li> <p>Zoom in, move and save the figure using the tool bar</p> </li> </ul>"},{"location":"crystal/#dichromatic-pattern","title":"Dichromatic pattern","text":"<p>A so-called dichromatic pattern is formed when two misoriented crystals are interpenetrated. The pattern is drawn according the usual convention: black and white crystals correspond to two different grains and different symbols to different layers (note that you can plot up to 7 different layers with different symbols).</p> <ul> <li> <p>To draw it  tick the <code>enable</code> box</p> </li> <li> <p>Enter a rotation <code>angle</code> between  the two crystal along the plane normal.</p> </li> <li> <p>Recalculate (press <code>Calculate</code>) and then <code>Draw</code></p> </li> <li> <p>Tick the <code>coincidence</code> box to highlight coincident site positions (need to <code>Calculate</code> again). The precision by which is defined coincidence  can be tuned in the <code>precision</code> field. It is expressed in % of the largest lattice parameter.</p> </li> <li> <p>Tick the <code>layers</code> button to show the layer number on the dichromatic pattern. From layers 0 to 5, markers are circles, squares, triangles, stars and hexagons, respectively. After they are all circles. </p> </li> <li> <p>Tick the <code>G2 positions</code> to draw atom position in the rotated crystal.</p> </li> </ul> <p></p> <p>Example of a dichromatic pattern in a (1,1,1) plane with a misorientation angle of 38.21\u00b0, in Al.</p>"},{"location":"crystal/#draw-vectors","title":"Draw vectors","text":"<p>Vectors can be plotted in direct or in reciprocal (plane normals) spaces either in a grain or in a dichromatic pattern.</p> <ul> <li> <p>Fill the <code>v</code> field with both a fractionnal constant and crystal indices.</p> </li> <li> <p>Press <code>+</code> button to add the vector to the list. Zoomed pattern are not reset when vectors are added. Press <code>Draw</code> to reset view. </p> </li> <li> <p>Vectors in the list appear as: <code>1/k [u,v,w]_i [t1,t2,t3], z</code>, <code>z</code> is the scalar product with the projected plane direction, i.e. indicate the out of figure coordinate.</p> </li> <li> <p>Shift a vector by changing the origin to the position <code>t</code> (default is [0,0,0]). <code>t</code> should be indicated in the directed space of the grain which can be easily found by plotting atom positions.</p> </li> <li> <p>Select a vector and remove it by pressing the <code>-</code> button. By default, the last vector enter is selected. </p> </li> <li> <p>When <code>normal</code> box is ticked the <code>v</code> vectors is treated as a plane normal. As it is much shorter the fractionnal value can be set less than 1.</p> </li> <li> <p>Tick <code>G2</code> to draw vectors in the second rotated crystal.</p> </li> <li> <p>Tick <code>label</code> to show labels associated to directions <code>[....]_1,2</code> or plane normals <code>(...)_1,2</code></p> </li> </ul> <p></p>"},{"location":"diffraction/","title":"Diffraction","text":"<p>Diffraction allows to determine orientation from a set of diffraction patterns.</p>"},{"location":"diffraction/#introduction","title":"Introduction","text":"<p>Determining orientation from diffraction patterns requires to collect and identify a set of diffraction vectors \\vec{q}. When using this approach, we assume that the diffraction vector is close to a Bragg condition, which is fulfill typically in a two-beam condition. This often needs to tilt the specimen. Alternatively we present in Kikuchi a method based on Kikuchi lines.</p> <p>Consider an electronic wave scattered by a crystal plane (h,k,l) corresponding to a diffraction vector \\vec{q}. Its amplitude and phase is given by:</p>  \\Psi(\\vec{q})=\\sum_{j=1}^N f_j e^{- 2i\\pi \\vec{q}\\cdot\\vec{r}_j}  <p>where the sum is made on all the atoms j placed at \\vec{r}_j in the unit cell.</p> <p>The intensity recorded is thus: </p>  I(\\vec{q})=\\Psi(\\vec{q})\\Psi^\\ast(\\vec{q})  <p>For a given crystal, the wave intensity will depend both on the \\vec{q}\\cdot\\vec{r} and on the atomic form factor f_j. </p> <p>Systematic extinctions</p> <p>Extinctions for specific (h,k,l) diffracted planes are expected if: $$ \\sum_{j=1}^N e^{- 2i\\pi (h \\cdot x_j + k \\cdot y_j  + l \\cdot z_j)}=0 $$ For fcc cubic crystals, with atoms placed at (x_j,y_j,z_j) = (0, 0, 0), (0.5, 0.5, 0) ,(0, 0.5, 0.5), (0.5, 0, 0.5), this condition is fulfilled when (h,k,l) are of different parity.</p> <p>The atomic form factor f_j corresponds to the amplitude of the wave diffracting on a single atom. The atomic form factor can be approximated by a Gaussian decomposition:</p>  f(q)=\\sum _{i=1}^{5}a_{i}\\exp \\left(-b_{i}\\left({\\frac {q}{4\\pi }}\\right)^{2}\\right)  <p>where the values of a_i, b_i can be found for every atoms in the International Tables for Crystallography Volume C p. 259.</p> <p>The position and the name of atoms are defined in the <code>space_group.txt</code> file following the scheme:</p> <pre><code>Name\nAtom name1 x1 y1 z1\nAtom name1 x2 y2 z2\n...\nAtom name2 x3 y3 z3\n</code></pre> <p>The atomic factor is defined in the <code>scattering.txt</code> file according to the scheme:</p> <pre><code>Atom name1 a1 a2 a3 a4 a5 b1 b2 3 b4 b5\n...\n</code></pre>"},{"location":"diffraction/#diffraction-pattern-in-tem","title":"Diffraction pattern in TEM","text":"<p>When a plane electronic wave is scattered by a crystal under a given orientation, a spot diffraction pattern is formed in the back focal plane of the objective lens. The spots correspond to different diffraction vectors \\vec{q}, the intensity of the pattern depending both on the crystal lattice and its orientation (see stereoproj). In Diffraction, we only use the structure factor as a guide to identify diffraction spots.  </p> <p>Thus, an electron wave traveling in the direction -z will be diffracted by an angle 2\\theta_B given by the Bragg law:</p>  2d \\sin{\\theta_B} = n \\lambda  <p>\\lambda being the wavelength, d the inter-reticular spacing and n the diffraction order (corresponding to parallel diffraction vectors n(h,k,l)).</p> <p>Diffracted spots will be located at a given distance r from the transmitted beam and at a given angle \\eta from a fixed direction, chosen here as the y axis.</p> <p></p> <p>The observed/recorded pattern will depend on:</p> <ul> <li> <p>the magnification due to intermediate and projection lenses. The distance r measured will thus depend on the value of L called the camera length, given by $$  L=\\frac{rd}{n\\lambda} $$ As a consequence, the pattern will depend on the acceleration voltage, through the wavelength.</p> </li> <li> <p>the rotation, by an angle \\xi, between the \\alpha-tilt axis which defines the y axis in the holder reference frame, and the y axis on the pattern. </p> </li> </ul> <p>Two-beam and three-beam conditions</p> <p>In a two-beam condition (left picture), only one diffraction vector is strongly excited. In that case \\vec{g} is located on a sphere of radius 1/\\lambda, the Ewald sphere, corresponding to the exact Bragg condition (s, the deviation from this condition is zero). In that condition, the Kikuchi lines lie at (0,+\\vec{g}). However, the diffraction planes are rotated of an angle \\theta_B with respect to the electron beam. This angle is usually small, but depend both on the acceleration voltage (through 1/\\lambda) and the interplanar spacing (d). At 200 kV, in iron austenite, \\theta_B \\approx 0.4^\\circ for the (200) vector.</p> <p>In a three-beam condition (right), the crystal is tilted by an angle \\theta_B from the two-beam conditions. Now the Kikuchi lines, are located between the transmitted beam and the diffracted beams. Three beams (0,-\\vec{g},\\vec{g}) are equally excited and the planes are perpendicular to the electron beam. This corresponds to a situation where s=-\\lambda/2 \\|\\vec{g}\\|^2.</p> <p></p> <p>A high accuracy of orientation thus needs the knowledge of s, i.e. the position of the Kikuchi lines. Please refer to Kikuchi, for such analysis. </p> <p>When taking a diffraction pattern, it is thus recommended to fulfill the three-beam conditions, i.e. in the middle of the extinction contours in image mode. However better imaging conditions are reached in two-beam with s&gt;0. </p> <p>Pycotem allows to correct the orientation of a diffraction vector from a two-beam condition. See below.</p>"},{"location":"diffraction/#calibration-and-operating-conditions","title":"Calibration and operating conditions","text":"<p>The diffraction pattern needs to be carefully calibrated on the microscope used. Use a crystal with known lattice parameters and record a diffraction pattern, ideally forming rows or a zone axis with a large value of n. For every camera length and acceleration voltage, measure r in pixels corresponding to d in angstroms.</p> <p>The calibration are set in the <code>calibration.txt</code> file following the scheme:</p> <pre><code>Microscope_name voltage camera length binning r.d\n...\n</code></pre> <p>For Diffraction,  both the value r . d and the acceleration voltage (in kV) are necessary, the other fields are informative.  </p>"},{"location":"diffraction/#orientation-from-a-set-of-diffraction-vectors","title":"Orientation from a set of diffraction vectors","text":"<p>If a set of diffraction vectors are given, the orientation can be retrieved knowing the position of the vectors in the microscope coordinates M (see below regarding ambiguities). Given the direction X in the crystal C coordinates:</p>  G_C  X = G_M   \\begin{pmatrix}  1\\\\ 0 \\\\ 0    \\end{pmatrix}  <p>where </p>  G_C=D^\\ast \\begin{pmatrix}  h_1 &amp; k_1 &amp; l_1\\\\ &amp; ... &amp; \\\\ h_N &amp; k_N &amp; l_N      \\end{pmatrix}  <p>are the g-vectors in the crystal coordinates and D^\\ast is defined here, and: </p>   G_M=\\begin{pmatrix}  x_1 &amp; y_1 &amp; z_1\\\\ &amp; ... &amp; \\\\ x_N &amp; y_N &amp; z_N      \\end{pmatrix}  <p>are the g-vectors in the sample coordinates.</p> <p>The coordinates x_i,y_i,z_i are obtained by appropriate rotation in the sample coordinates. For a double tilt holder, with no angle between the vertical direction and the \\alpha-tilt axis, the coordinates of the diffraction vector i is <sup>1</sup>:</p>  \\begin{pmatrix}  x_i\\\\ y_i \\\\ z_i  \\end{pmatrix} = R_x(-\\beta_i) R_y(-\\alpha_i) R_z(-\\eta_i) \\begin{pmatrix}  0\\\\ 1 \\\\ 0    \\end{pmatrix}  <p></p> <p>Example of a tilt sequence in a double tilt holder. The recorded diffraction vector (1,1,1) is obtained after rotating along x of an angle \\beta=-20, then along \\alpha=10. The inclination made on diffraction pattern with the \\alpha-tilt axis (here along the y direction) is \\eta=40.</p> <p>The equations</p>  G_CX=G_M [1,0,0]^T \\\\ G_CY=G_M [0,1,0]^T \\\\ G_CZ =G_M [0,0,1]^T  <p>lead to:</p>  G_C A=G_M  <p>The above equation defines the crystal orientation, so that A should be a rotation matrix. The closest Euler rotation matrix R can be found with the approach proposed by Mackenzie <sup>2</sup> using singular value decomposition:</p>  U,S,V^T=svd(G_C^TG_M) \\\\ R=V U^T  <p>The Euler angles are retrieved from the R matrix:</p>  \\varphi_1 = \\arctan (R_{02}, R_{12}) \\\\ \\phi = \\arccos(R_{22}) \\\\ \\varphi_2 = \\arctan (R_{20},R_{21})  <p>180\u00b0 ambiguity</p> <p>When the inputs g-vectors are, for instance, coplanar, the retrieved orientation may suffer the 180\u00b0 ambiguity. </p> <p>The situation described on the left side of the figure below is ambiguous. In this case, the 180\u00b0 rotation along g_3 leads two different crystal orientations. On the contrary, the right side of the figure is not ambiguous, as the 180\u00b0 rotation along (0\\bar{1}1) is a crystal symmetry. </p> <p>Same ambiguities can arise when indexing zone axes that present a 180\u00b0 rotational symmetry which does not exist in the crystal.  Finally, in addition, if two orientations differs from a rotation of given axis, a set of diffraction vectors located on equivalent invariant rotation axes by crystal symmetry (see misorientation) will hence give rise to ambiguity. </p> <p>In Diffraction ambiguous results can be detected.</p> <p></p>"},{"location":"diffraction/#interface","title":"Interface","text":"<p>The interface is composed of  a top bar menu, a plotting area to display diffraction patterns and a setting/results panel.</p> <p></p>"},{"location":"diffraction/#procedure","title":"Procedure","text":""},{"location":"diffraction/#defining-the-crystal-structure","title":"Defining the crystal structure","text":"<p>Crystal structure can be imported from the <code>structure</code> menu. This menu can be populated by adding structures in the <code>structure.txt</code> files following the template:</p> <pre><code>Name a(A) b(A) c(A) alpha beta gamma space group\n</code></pre> <p>The space group is defined in the <code>space_group.txt</code> file and with the  <code>scattering.txt</code> file as defined above.</p> <p>Alternatively, the structure can be set by filling the a,b,c  and \\alpha, \\beta, \\gamma fields.</p>"},{"location":"diffraction/#workflow","title":"Workflow","text":"<ul> <li> <p>Open a diffraction pattern. Make sure that the file name does not contain non-ASCII characters.</p> </li> <li> <p>Define a calibration in the <code>Calibrations</code> box</p> </li> <li> <p>Set the <code>Diffraction alpha y-axis angle</code> (see stereoproj )</p> </li> <li> <p>Left click on a diffraction spot. Zoom in to ensure a higher precision. </p> </li> <li> <p>Click again on a second spot corresponding to the diffraction order n.</p> </li> <li> <p>Indicate the order n in the <code>diffraction order</code> field.</p> </li> <li> <p>Click <code>reset view</code>  or <code>reset point</code>  if needed</p> </li> </ul> <p></p> <ul> <li>The distance d (A) and the inclination angle \\eta are indicated in the Dist, Inclination box.</li> </ul>"},{"location":"diffraction/#option-1-computer-aided-determination-of-hkl-indices","title":"Option 1: computer-aided determination of (h,k,l) indices","text":"<p>In most of case, the reflection indices can be determined unambiguously from their d-spacing.</p> <ul> <li> <p>Indicate a value in px  in the <code>precision</code> box. The g-vectors will be chosen within the uncertainty range \\pm the precision. By default, the value is 10 px.</p> </li> <li> <p>Select the d-spacing  in the Dist, Inclination box.</p> </li> <li> <p>Click on <code>Find diffraction spots</code> to identify the spot. The results appear in the g vectors box with the scheme <pre><code>d(A) |  h,k,l  (m) | Intensity(arb. units) | angles\n</code></pre> The angles values are explained below. The <code>(m)</code> indice will appear if (h,k,l) is a multiple of an equivalent one, i.e. is (2h_0,2k_0,2l_0) or (3h_0,3k_0,3l_0) of same intensity.</p> </li> </ul> <p>The data (h,k,l), the inclination angle \\eta and the tilt angles, can be used to plot stereographic projection from a diffraction vector</p> <p>Thus for every diffraction patterns, the diffraction vector, inclination angle, and tilt angles need to be provided. </p> <ul> <li> <p>Fill the tilt angles fields.  Tick the box to indicate that rotation is anti-clockwise.</p> </li> <li> <p>Tick the <code>2-to-3 beams</code> box if a correction from a 2-beam to a 3-beam condition is required (see above). This leads to the evaluation of the out of plane angle \\epsilon.</p> </li> <li> <p>Click and <code>Find diffraction spots</code></p> </li> <li> <p>Select both the dist, inclination field and the appropriate g vector. For the first condition, the indices of the g-vector can arbitrary be chosen. </p> </li> <li> <p>Press <code>Add data</code>. A line appears <code>alpha angle, beta angle, theta angle, inclination, h,k,l, epsilon angle</code>. Data can be removed by selecting the line and by pressing <code>Remove data</code>.</p> </li> <li> <p>Repeat the above operations for at least 2 diffraction spots. For every conditions, the angle between the proposed g-vectors and the already chosen g-vectors are indicated. Choose the (h,k,l) indices that minimize all the angles.</p> </li> </ul> <p></p>"},{"location":"diffraction/#option-2-automatic-determination","title":"Option 2: Automatic determination","text":"<p>When the reflections are ambiguous from their d-spacing, consistent sets of data can be retrieved by comparing the measured angles \\theta_{ij}=\\angle{(\\vec{g}_i,\\vec{g}_j)} with a lookup table compiling the angles \\theta'_{ij}=\\angle{((h_i,k_i,l_i),(h_j,k_j,l_j))}. The sets of  g-vectors are obtained if all the angle differences \\left|\\theta_{ij}-\\theta'_{ij}\\right| is less than a tolerance angle equals to 10 degrees and if the relative interplanar distance differences \\frac{\\left|d_{hkl}-d'_{hkl}\\right|}{d_{hkl}} are less than a precision indicated in the <code>precision</code> field. To proceed this way:</p> <ul> <li> <p>Tick the <code>do not use g-vector guess</code> box.</p> </li> <li> <p>Choose a precision in % (default is 10%)</p> </li> <li> <p>Add the spot as above. The indices will appear as <code>0,0,0</code>.</p> </li> </ul>"},{"location":"diffraction/#retrieve-orientation","title":"Retrieve orientation","text":"<ul> <li>Select the data lines and press <code>Get orientation</code> </li> </ul> <p>The result box shows: </p> <p><pre><code>phi1, phi, phi2 (Euler angles)\nmean angular deviation, mean d-spacing deviation\n</code></pre> In case of option 2, the (hkl) indices are indicated.</p> <p>Two sets of <code>phi1, phi, phi2</code> angles are displayed if the results are ambiguous.</p> <p>The accuracy of the result is given by: </p> <ul> <li>The <code>mean angular  deviation</code>, which is the average angle between each diffraction vector computed from the Euler angles and the experimental values:</li> </ul>  \\langle \\theta_d \\rangle = \\frac{1}{N}{\\sum_i^N \\left| \\arccos(R \\vec{g}_i \\cdot [x_i,y_i,z_i]^T) \\right|}  <p>where \\vec{g}_i is the normalized diffraction vector corresponding to the (h_i,k_i,l_i) plane.</p> <ul> <li>The <code>mean d-spacing deviation</code>, in percents, is the mean spread between measured and expected d-spacings. It should be of typically less than 10/%</li> </ul>  \\langle d \\rangle= \\frac{1}{N}{\\sum_i^N \\left| \\frac{d_{hkl}-d_i}{d_{hkl}}\\right|}  <ul> <li>In case of option 2, the results are sorted by ascending order of mean deviation angles and mean d-spacings.</li> </ul> <p></p>"},{"location":"diffraction/#importexport-data","title":"Import/Export data","text":"<p>Using the <code>Data</code> menu, data can be imported and results exported.  Data sets are provided in a <code>.txt</code> file using the following scheme</p> <pre><code># Diffraction data file \nalpha_1,beta_1,theta_1,eta_1,h_1,k_1,l_1,epsilon_1\n...\nalpha_N,beta_N,theta_N,eta_N,h_N,k_N,l_N,epsilon_N\n</code></pre> <p>Exporting data will write in a <code>.txt</code> file,  adding to the above datasets:</p> <p><pre><code># Results \n# Phi1,Phi,Phi2\n# phi_1,phi, phi_2\n# Mean angular deviation, Mean square angular dev.\n# ang_d, ang_d^2\n</code></pre> The two files can be combined in one as <code>#</code> sign will not be read during import.</p>"},{"location":"diffraction/#spectrum","title":"Spectrum","text":"<p>Spectra, i.e. peak intensity with respect to the d-spacing, can be plotted from the top menu. The maximum indices should be indicated.</p> <p></p> <ol> <li> <p>if the diffraction is taken away from the three-beam condition, an extra rotation R_x(\\epsilon) applies, with \\epsilon = \\theta_B+s/\\|\\vec{g}\\|^2.\u00a0\u21a9</p> </li> <li> <p>J. Mackenzie, Acta Cryst. 1957, 10, 61.\u00a0\u21a9</p> </li> </ol>"},{"location":"interface/","title":"Interface","text":"<p><code>interface</code> allows to determine interface normal or direction from a set of images.</p>"},{"location":"interface/#introduction","title":"Introduction","text":"<p>Determining an interface plane can be performed using a series of TEM images (usually in Bright Field) acquired during a tilting series. Here we show how to get a quantitative assessment of the interface normal.</p> <p>In TEM, a plane interface of normal \\vec{n} appear as a projection in the viewing screen. For a given orientation determined by the beam direction \\vec{b}_e in the sample reference frame (noted with the subscript S), the interface plane is fully described by the direction of the projected traces \\vec{t}_p that correspond to the intersection between the foil surface \\vec{s} and the plane. In the projected plane coordinates (noted with P), the direction of the trace can be characterized by the azimuth angle \\eta with the y_P direction. Note that because of the electron optics, the projected plane frame can be rotated with respect to the holder coordinate system (noted with H) along z_P=z_H (see this section, for the definition of the holder coordinate system). </p> <p>If the two surfaces are parallel the two projected traces are also parallel (fig. a). Thus, the width w between the two traces can be also measured. These data constitute the set (\\vec{b}_e, \\eta ,w). If the surfaces are not parallel, the approach described below still works if a specific point C (projected on H) can be tracked (fig. b).</p> <p></p> <p>It can be shown that the apparent width w is given by:</p>  w= \\frac{ \\lvert d\\vec{n} \\cdot \\vec{b}_e \\rvert}{\\sqrt{ 1- (\\vec{b}_e \\cdot \\vec{t})^2}}  <p>The unit normal vector \\vec{n} can be estimated following the two steps procedure:</p> <ul> <li>first solve \\vec{t} following the m equations:</li> </ul>  [\\vec{b}_{e1} \\times \\vec{t}_{p1}, ..., \\vec{b}_{em} \\times \\vec{t}_{pm} ]^T \\cdot \\vec{t} =0  <ul> <li>then solve :</li> </ul>  \\left[\\begin{array}{c} \\vec{b}_{e1}^\\mathrm{T} \\\\[2mm] \\vec{b}_{e2}^\\mathrm{T} \\\\[2mm] ...\\\\ \\vec{b}_{em}^\\mathrm{T} \\\\[2mm] \\vec{t}^\\mathrm{T} \\end{array}\\right] (d \\vec{n}) =\\left[\\begin{array}{c}  \\mathrm{sgn}(1) w_1\\sqrt{1- \\left(\\vec{b}_{e1} \\cdot \\vec{t} \\right)^2}\\\\[0.5mm] \\mathrm{sgn}(2)w_2\\sqrt{1- \\left(\\vec{b}_{e2} \\cdot \\vec{t} \\right)^2}\\\\[0.5mm] ...\\\\ \\mathrm{sgn}(m)w_m\\sqrt{1- \\left(\\vec{b}_{em} \\cdot \\vec{t} \\right)^2}\\\\[0.5mm] 0 \\end{array} \\right]  <p>the \\mathrm{sgn}(i) here denotes that although the measure width is always positive, the dot product \\vec{b}_{ei} \\cdot \\vec{n} can be negative.</p> <p>The equation can be solved using the least square method, by varying \\mathrm{sgn}(i). The solution with the smallest residual is considered to be the correct one.</p> <p>The inputs data used are for a double tilt holder using the convention described in stereoproj derived from the position of the beam direction and apparent trace direction in the sample coordinates:</p>  \\vec{b}_{ei}=R_x(-\\beta_i)R_y(-\\alpha_i)[0,0,1]^T \\\\ \\vec{t}_{pi}=R_z(-\\eta)[0,1,0]^T"},{"location":"interface/#line-determination","title":"Line determination","text":"<p>The same approach can be used to determine a linear feature \\vec{l} using the data sets (\\vec{b}_{ei}, \\vec{l}_{pi}, l_i) by solving:</p>  [\\vec{b}_{ei} \\times \\vec{l}_{pi}, \\vec{l}_{pi}]^T d\\vec{l} =[0, sgn(i) l_i]^T"},{"location":"interface/#interface","title":"Interface","text":"<p>The interface is composed of  a top bar menu, a plotting area to display images and a setting/results panel.</p> <p></p>"},{"location":"interface/#procedure","title":"Procedure","text":""},{"location":"interface/#settings","title":"Settings","text":"<p>The interface normal can be determined in the sample frame. If necessary it can be determined in the crystal frame if both the nature of crystal and its orientation are known. This requires to tick the <code>Use lattice coordinates</code> button.</p> <p>Crystal structure can be imported from the <code>structure</code> menu or by filling the a,b,c and \\alpha,\\beta,\\gamma fields. </p> <p>Microscope calibration need to be set to get correct scaling when the apparent widths w are measured. If the box is set to <code>uncalibrated</code> measured will be performed in pixels. Calibrations can be set in the <code>microscope.txt</code> file with the following scheme:</p> <pre><code>Microscope_name Magnification nm/px delta(\u00b0)\n</code></pre> <p>The \\delta angle is the angle between the y axis and the \\alpha-tilt axis. It can also be entered directly in the <code>image-alpha tilt</code> box. When calibrated, the <code>Magnification</code> field can be filled. Note that magnification entered are multiplied by 1000.</p>"},{"location":"interface/#getting-data","title":"Getting data","text":"<ul> <li> <p>Select the holder configuration</p> </li> <li> <p>Open an image taken at a given \\alpha, \\beta, \\theta angles. Anticlockwise rotation can be indicated in the <code>AC</code> box. Make sure that the file name does not contain non-ASCII character.</p> </li> <li> <p>Select the corresponding magnification for a given microscope setting</p> </li> <li> <p>On the image, define the apparent trace direction by clicking on two points. Click a third point on the second trace (from a reference point if the traces are not parallel). Zoom in the image if necessary. The view and points can be reset using the two corresponding buttons. Press <code>ctrl+w</code> to remove the last point. </p> </li> <li> <p><code>Add data</code> to the list. In the data box below appears <code>width, eta angle, alpha, beta, theta</code></p> </li> <li> <p>Repeat the operation to get at least 3 conditions but 5-6 will improve accuracy. Select the lines used for the analysis</p> </li> <li> <p>Press the <code>Get normal/direction</code> to get the plane normal. The results appear as:</p> </li> </ul> <pre><code>Plane normal\nx, y, z (or h,k,l if using the lattice coordinates)\nTrace \nxt,yt,zt\nError on trace direction (\u00b0)\nvalue\nError on plane normal (\u00b0)\nvalue\nPlane width\nd in px or nm if calibrated\nError on plane width\nvalue in px or nm\nEstimated thickness\nvalue +/- in  px or nm\n</code></pre> <p></p> <p>Results accuracy</p> <p>Errors are computed using the bootstrap method. Starting from the set of data (\\vec{b}_{ei}, \\eta_i) or  (\\vec{b}_{ei}, w_i), to estimate the trace direction and normal, respectively, the data sets were resampled and estimated traces and normals were determined using the equation above. The 95% confidence interval was calculated from the 92th percentile of deviation of the trace and normal. This indicates that the normal should stay in a cone centered around \\vec{n} with a deviation of \\Delta\\theta=\\widehat{(\\vec{n},\\vec{n}'_{0.95})}. </p> <p>The same procedure is carried out also in case of the measurement of  direction which leads to \\Delta\\theta=\\widehat{(\\vec{l},\\vec{l}'_{0.95})}. </p> <p>Note that for some configurations, the confidence interval may be excessively large due to spurious resampling. Adding multiple data, ie. several measurements will prevent from this effect.</p> <p>The sample thickness can be estimated from <sup>1</sup>:</p>  t=d\\sqrt{1-(\\vec{n}\\cdot\\vec{s})^2}=d\\vec{l}\\cdot\\vec{s}  <p>\\vec{s} being the foil normal. It is estimated in the results by considering that the foil normal is along z_M. The error on the estimation is complex because it depends both on the error on d and on the deviation of \\vec{n} or \\vec{l}. The two contributions can be approximately estimated to provide an error on the thickness.</p> <p></p> <p>Example of interface determination from a set of images (see here). Cones around n and t (normal and trace) corresponds to the 92% confidence interval.</p>"},{"location":"interface/#drawing","title":"Drawing","text":"<p>Drawing interface projection can be done using the <code>Draw</code> menu.</p> <ul> <li> <p>Enter crystal thickness. Use the value given in the result box.</p> </li> <li> <p>Surface normal can be indicated if known by ticking the <code>surf</code> box. Otherwise the surface is chosen as the plane normal to beam direction at zero tilt, which is usually a good approximation. Surface normal can be determined by the method shown here if two interface traces are present.</p> </li> <li> <p>Enter the plane. Direction can be plotted if the <code>dir.</code> box is ticked.</p> </li> <li> <p>A label can be displayed when the <code>label</code> box is ticked.</p> </li> <li> <p>If the crystal is hexagonal, tick the <code>hexa</code> box to get the correct 4 indices for directions (the third indices is omitted)</p> </li> <li> <p>Click on one trace. Don't forget to fill the tilt angles and microscope settings.</p> </li> <li> <p>Press <code>OK</code> to plot the two apparent traces at the clicked point.</p> </li> <li> <p>Press <code>ctrl+w</code> while in the draw window to remove the last plot.</p> </li> </ul> <p></p> <ul> <li> <p>The same procedure can be applied to determined and draw directions. The <code>direction</code> box should then be checked.</p> </li> <li> <p>To reverse the drawing direction checked the <code>inv</code> button.</p> </li> </ul> <p></p>"},{"location":"interface/#measuring","title":"Measuring","text":"<p>If two points are defined on the image, if the <code>measure</code> box is ticked, and if a plane is indicated, a result field appears in the dialog window.</p> <p>It indicates:</p> <ul> <li> <p>the distance measured in the plane (in nm if calibrated)</p> </li> <li> <p>the direction in the plane</p> </li> <li> <p>the maximum length in the direction, according to the sample thickness</p> </li> <li> <p>the measure projected length (in nm)</p> </li> </ul> <p></p> <p>If the <code>proj. image</code> is checked, a stretched image is displayed. It corresponds to the image in the indicated plane. It allows to make directly measurement in this image without perspective effects. A <code>scale</code> of a given length can be added.  In the <code>draw window</code> is also indicated a rotation and stretch coefficient.</p> <p></p>"},{"location":"interface/#importexport-data","title":"Import/Export data","text":"<p>Using the <code>Data</code> menu, data can be imported and results exported.  Data sets are provided in a <code>.txt</code> file using the following scheme</p> <pre><code># Interface data file \n# Euler angles \nphi1,phi, phi2 (may be left blank)\n# Data for a  plane/direction\nw_1(or l_1), eta_1,alpha_1,beta_1,theta_1\n...\nw_N(or l_N), eta_N,alpha_N,beta_N,theta_N\n</code></pre> <p>Exporting data will write in a <code>.txt</code> file,  adding to the above datasets. For plane:</p> <pre><code># Results \n# Plane normal\n# n_1,n_2, n_3 \n# Trace\n# t_1,t_2,t_3\n# Error on trace direction (deg)\n# ang\n# Error on plane normal (deg)\n# ang\n# Plane width\n# d\n# Error on plane width\n# dd\n# Estimated thickness\n# t\n</code></pre> <p>for directions:</p> <p><pre><code># Results \n# Direction\n# d1,d2,d3\n# Error on trace direction (deg)\n# ang\n# Direction length\n# l\n# Error on direction width\n# dl\n# Estimated thickness\n# t\n</code></pre> The two files can be combined in one as <code>#</code> sign will not be read during import.</p> <ol> <li> <p>i.e. given a plane apparent width t=w \\large| \\frac{\\sin(\\vec{b}_e,\\vec{t}) \\sin(\\vec{n},\\vec{s})}{\\cos(\\vec{n},\\vec{b}_e)}\\large| or given a projected length t=l \\large|\\frac{\\cos (\\vec{l},\\vec{s})}{\\cos(\\vec{l_p},\\vec{l})} \\large| \u21a9</p> </li> </ol>"},{"location":"kikuchi/","title":"Kikuchi","text":"<p><code>kikuchi</code> allows to determine orientation from a kikuchi pattern.</p>"},{"location":"kikuchi/#introduction","title":"Introduction","text":"<p>Kikuchi lines result from inelastic scattering in a sufficiently thick crystal. Considering an electron beam entering the crystal, electron are scattered in different directions, but more likely in the forward direction. The electrons that are in Bragg conditions, i.e. forming an angle \\pm \\theta_B, with an atomic plane will eventually be diffracted. Their wave vectors \\vec{k}_0, \\vec{k}'_0 are distributed in two Kossel cones of aperture 90-\\theta_B,  around the plane normal, corresponding to the diffraction vectors \\vec{g} or \\vec{g}'=-\\vec{g}. The diffracted beam with wave vectors \\vec{k}_g and \\vec{k}'_g, which are also distributed on the cones, intersect the observation screen and form lines, as \\theta_B is small. Because the inelastic scattering is more intense in the forward direction, the diffracted beam \\vec{k}_g gives rise to a line with a higher intensity, i.e. an excess line. On the contrary, \\vec{k}'_g corresponds to a defected line.</p> <p></p> <p>The defected and excess lines are separated by the angle 2\\theta_B which in the observation plane corresponds to a distance</p>  r \\approx L\\theta_B = \\frac{\\lambda L}{d}   <p>where L is the camera length, i.e. the effective distance between the back focal plane of the objective lens and the observation screen, \\lambda the electron wavelength, and d the interplanar distance related to the (h,k,l) plane.</p> <p>Thus, the nature of the Kikuchi bands can be determined, knowing the calibration parameter L, the electron wavelength, which depends on the acceleration voltage and the crystal structure.</p>"},{"location":"kikuchi/#indexing-kikuchi-bands","title":"Indexing Kikuchi bands","text":"<p>(h,k,l) bands can be retrieved, knowing the crystal structure. It can be imported from the <code>structure</code> menu. This menu can be populated by adding structures in the <code>structure.txt</code> files following the template:</p> <pre><code>Name a(A) b(A) c(A) alpha beta gamma space group\n</code></pre> <p>The space group is defined in the <code>space_group.txt</code> file and with the  <code>scattering.txt</code> file (see diffraction for more details).</p> <p>Alternatively, the structure can be set by filling the a,b,c  and \\alpha, \\beta, \\gamma fields.</p>"},{"location":"kikuchi/#calibration","title":"Calibration","text":"<p>The Kikuchi pattern needs to be calibrated on the microscope used but the calibration can be adjusted afterward. </p> <p>The calibrations are set in the <code>calibration.txt</code> file following the scheme:</p> <pre><code>Microscope_name voltage camera length binning r.d\n...\n</code></pre>"},{"location":"kikuchi/#orientation","title":"Orientation","text":"<p>Orientation of the crystal can be retrieved from the analysis of the band configuration in an approach similar to the one described in diffraction.</p> <p>The figure below shows the relation between the Kikuchi bands that can be defined by their normal vector \\vec{v}_{i} and their projection \\vec{v}_{pi} in the observation plane normal to vector \\vec{z}_P, i.e. the reverse of the electron beam direction <sup>1</sup>.</p> <p>From the projected vector, the normal band vector in the viewing screen coordinate system (x,y,z)_P can be deduced knowing the camera length L=\\|\\vec{OP}\\|:</p>  \\vec{v}_i=[x_i,y_i,z_i]^T=\\vec{v}_{pi}+[0,0,\\|\\vec{v}_{pi}\\|^2/L]^T  <p></p> <p>Considering N bands, the orientation can be defined by: </p>  G_C A=G_M  <p>with</p>  G_C=D^\\ast \\begin{pmatrix}  h_1 &amp; k_1 &amp; l_1\\\\ &amp; ... &amp; \\\\ h_N &amp; k_N &amp; l_N      \\end{pmatrix}  <p>the g-vectors in the crystal coordinates and D^\\ast is defined here, and: </p>   G_M=\\begin{pmatrix}  x_1 &amp; y_1 &amp; z_1\\\\ &amp; ... &amp; \\\\ x_N &amp; y_N &amp; z_N      \\end{pmatrix}  <p>As the above equation defines the crystal orientation, A should be a rotation matrix. The closest Euler rotation matrix R can be found with the approach proposed by Mackenzie using singular value decomposition:</p>  U,S,V^T=svd(G_C^TG_M) \\\\ R=V U^T  <p>The Euler angles are retrieved from the R matrix:</p>  \\varphi_1 = \\arctan (R_{02}, R_{12}) \\\\ \\phi = \\arccos(R_{22}) \\\\ \\varphi_2 = \\arctan (R_{20},R_{21})  <p>In diffraction, the g-vectors in crystal coordinates are determined step by step by calculating the angles between the vectors, and letting the user to choose.  Kikuchi bands usually have higher indices so that it is more difficult to guess the right indices.  Here we choose to compare the relative measured angles of g-vectors \\theta_{ij}=\\angle{(\\vec{g}_i,\\vec{g}_j)} with a lookup table compiling the angles \\theta'_{ij}=\\angle{((h_i,k_i,l_i),(h_j,k_j,l_j))}. A consistent set of  g-vectors is obtained if all the angle differences \\left|\\theta_{ij}-\\theta'_{ij}\\right| is less than a tolerance angle \\epsilon that can be chosen.  </p>"},{"location":"kikuchi/#interface","title":"Interface","text":"<p>The interface is composed of  a top bar menu, a plotting area to display Kikuchi pattern and a setting/results panel.</p> <p></p>"},{"location":"kikuchi/#procedure","title":"Procedure","text":"<ul> <li> <p>Enter the crystal structure and space group.</p> </li> <li> <p>Select the maximum indices for band identification.</p> </li> <li> <p>Enter the microscope calibration.</p> </li> <li> <p>Open a pattern.</p> </li> <li> <p>Click on the pattern center and press <code>Add center</code>. Position of the center appears in the box.</p> </li> <li> <p>To highlight the bands, the <code>brightness</code> can be adjusted.</p> </li> <li> <p>Select a band by clicking three times. The first two points define the direction along one line. The third point should be on the second parallel line. Then, both the d-spacing and the projected g-vector can be retrieved. A better accuracy can be achieved if the direction is measured with two extreme points along the line. Zooming in the pattern can also be helpful.</p> </li> <li> <p>Press <code>Add bands</code>. The band number and the corresponding (projected) d-spacing dp (in px) appears in the Bands box. Bands can be removed by pressing the <code>Remove band</code> button.</p> </li> <li> <p>Clear the points and view (if zoomed in) with the <code>Reset points</code> and <code>Reset view</code> buttons.</p> </li> <li> <p>Repeat the operation at least twice and no more than 6 times (2 to 6 bands to identify). </p> </li> <li> <p>Choose a tolerance angle \\epsilon less than 3 degrees. 1 by default.</p> </li> <li> <p>Plot the bands to verify the measured bands.</p> </li> <li> <p>Press the <code>Run</code> button to display solutions in the Results box. If no solutions, remove the bands and try a more accurate point and click and/or increase the tolerance angle.</p> </li> <li> <p>By selecting the different sets of data and by clicking on the <code>Show bands</code> button, the theoretical bands are plotted in overlay. The results are shown according the scheme:</p> </li> </ul> <pre><code>g: [h1,k1,l1],....,[hN,kN,lN]\nEuler angles phi1, phi, phi2\ndev_angle, dev_width\n...\n</code></pre> <p>The <code>dev_angle</code> value corresponds to the mean misorientation: </p>  \\langle \\Delta \\theta \\rangle = \\frac{1}{N}{\\sum_i^N \\left| \\arccos(R \\vec{g}_{h_i k_i l_i} \\cdot [x_i,y_i,z_i]^T) \\right |}  <p>The <code>dev_width</code> value corresponds to the mean deviation on the d spacing values (in percents).</p>  \\langle \\Delta d \\rangle= \\frac{1}{N} {\\sum_i^N  \\frac{\\left|d_{h_i k_i l_i} - d_i \\right|}{d_{h_i k_i l_i}} }  <p></p> <p>These two values should be as minimum as possible. Usually a good fit can be obtained with \\langle \\Delta \\theta \\rangle of the order of 0.2 degrees and \\langle \\Delta d \\rangle of the order of few percents.</p>"},{"location":"kikuchi/#refining-the-results","title":"Refining the results","text":"<p>Refining the results can be made from the <code>Refine</code> menu:</p> <ul> <li> <p>Manual rotations along x, y and z axes can be performed to judge the qualitative agreement between the pattern and the theoretical lines.</p> </li> <li> <p>The calibration and acceleration voltage can also be adjusted. By clicking the <code>update</code> button, the solutions are re-calculated using the new sets of values. A better fit can be judged by inspecting how \\langle \\Delta \\theta \\rangle and \\langle \\Delta d \\rangle are minimized.</p> </li> <li> <p>The updated Euler angles can be read at the bottom of the refine window.</p> </li> </ul> <p></p>"},{"location":"kikuchi/#tilt-conditions","title":"Tilt conditions","text":"<p>By default the orientation determined corresponds to the situation of the holder at zero tilt the Euler angle being given in the (x,y,z)_P coordinate system. To retrieve the Euler angle at zero tilt from a tilted sample, the \\alpha, \\beta, \\theta tilt angles and the angle \\xi between the \\alpha-tilt axis and the y-axis should be indicated as the Euler rotation matrix at zero tilt R_0 is deduced from the rotation matrix R_t obtained by the relation:</p>  R_0=R_z(-\\xi)R_y(-\\alpha)R_x(-\\beta)R_z(\\xi)R_t  <ul> <li>Fill the filed in the Tilt conditions window accessed from the <code>Tool</code></li> <li>Press <code>Run</code> in the main window or <code>Update</code> in the Refine window to update the Euler angles.</li> </ul> <p></p> <ol> <li> <p>Note that considering vectors pointing downward in the electron beam direction lead to similar results except the pattern is inverted. This inversion is taken into account here.\u00a0\u21a9</p> </li> </ol>"},{"location":"misorientation/","title":"Misorientation","text":"<p><code>misorientation</code> allows to determine orientation relationship and misorientation between two crystals It allows:</p> <ul> <li> <p>Display two crystals at the same time on a stereographic projection which allows the easy determination of orientation relationship</p> </li> <li> <p>Orient two crystals independently</p> </li> <li> <p>Determine misorientation between two grains (same crystals)</p> </li> </ul>"},{"location":"misorientation/#misorientation","title":"Misorientation","text":"<p>When two crystals are separated by a grain boundary, the neighboring crystals may exhibit a specific orientation relationship that can be defined by an interface and a couple rotation axis, i.e. a common crystal direction, misorientation angle.</p> <p>Considering the orientation of grains A and B defined by their Euler angles. Their orientation in the reference frame is defined by the orientation matrix O_1 and O_2. The misorientation matrix is given by:</p>  M=O_1 O_2^{-1}  <p>As M is a rotation matrix, one could extract the couple angle-axis, (\\theta,\\vec{u}) according to:</p>  \\theta=\\arccos \\left(\\frac{tr(M)-1}{2}\\right)  <p>and </p>  M\\vec{u}=\\vec{u}  <p>However, because of crystal symmetry, the misorientation between two grains is not unique, i.e. equivalent (\\vec{u},\\theta) exist. The misorientation axis should then be modified by:</p>  M=O_1O_SO_2^{-1}  <p>where O_S are the symmetry operations of the crystal. For cubic, it consists of:</p> <ul> <li> <p>Rotations along \\langle 100 \\rangle of 90\u00b0, 180\u00b0 and 270\u00b0 (9 rotations)</p> </li> <li> <p>Rotations along \\langle 110 \\rangle of 180\u00b0 (6 rotations)</p> </li> <li> <p>Rotations along  \\langle 111 \\rangle of 120\u00b0 and 240\u00b0 (8 rotations)</p> </li> <li> <p>Identity operation</p> </li> </ul> <p>Thus 24 symmetry operations can be applied, leading to 24 (\\vec{u},\\theta) couples.</p> <p>Equivalent considerations can be made for other crystal systems.</p>"},{"location":"misorientation/#interface","title":"Interface","text":"<p>The interface is composed of 3 tabs.</p> <ul> <li> <p>the settings tab is used to enter the 2 crystal inputs, the microscopic settings regarding rotation between tilt axis and image, and the layout. Refer to stereoproj for the details information.</p> </li> <li> <p>the stereo-proj tab is the plotting area</p> </li> <li> <p>misorientation tab display the misorientation between crystal (if identical crystal are selected)</p> </li> </ul> <p></p>"},{"location":"misorientation/#procedure","title":"Procedure","text":""},{"location":"misorientation/#plotting","title":"Plotting","text":"<ul> <li> <p>Set the crystal parameter and layout in the setting tab. Refer to stereoproj for the details.</p> </li> <li> <p>Enter the crystal 1 and 2 orientation in the Euler Angles fields</p> </li> <li> <p>Plot the stereographic projections using the <code>Plot</code> button</p> </li> </ul> <p></p> <p>Overlay of an aluminium and an zirconium crystal.</p> <ul> <li>Same additional features as in stereoproj are available: adding poles/directions, planes... and can be performed independently on crystal 1 or 2 by using the Switch button</li> </ul> <p></p> <ul> <li>Rotations can be performed along x,y,z or along a pole/direction (g) entered in the <code>Pole/direction</code> field, either in crystal 1 or 2</li> </ul>"},{"location":"misorientation/#misorientation_1","title":"Misorientation","text":"<p>For 2 crystals of the same structure, the misorientation can be computed after plotting the stereographic projection.</p> <p>In the misorientation tab:</p> <ul> <li> <p>press the <code>Find misorientation Plot Angle/Axis</code> button</p> </li> <li> <p>the rotation axes in both crystal are displayed along with the rotation angle</p> </li> <li> <p>if the <code>uvw</code> button is ticked in the setting tab, the axes will be given as directions and not plane normals.</p> </li> <li> <p>in the stereographic tab, the axes appear as black dots.</p> </li> <li> <p>ticking the <code>show numbers</code> or <code>show axes</code> will display the number corresponding to the angle/axis couples and the axis indices in crystal 1 on the stereographic projection, respectively.</p> </li> </ul> <p></p>"},{"location":"ressources/","title":"Further ressources","text":""},{"location":"ressources/#running-tests","title":"Running tests","text":"<p>Images and diffraction patterns are available here.</p> <p>Information are given in the <code>test.txt</code> file. Kikuchi pattern, diffraction patterns and a series of bright field images can be used to test kikuchi, diffraction and interface.</p>"},{"location":"ressources/#references","title":"References","text":""},{"location":"ressources/#general","title":"General","text":"<ul> <li> <p>Transmission Electron Microscopy, by D. Williams and C.B. Carter  link</p> </li> <li> <p>Transmission Electron Microscopy, by L. Reimer link</p> </li> <li> <p>Defect analysis in Electron Microscopy, by M. H. Loretto and I. Smallmann</p> </li> <li> <p>Practical Electron Microscopy in Materials Science, by J.W. Edington</p> </li> </ul>"},{"location":"started/","title":"Getting started","text":""},{"location":"started/#executables-windows","title":"Executables (Windows)","text":"<p>Latest Windows executables can be downloaded here</p> <p>Unpack the folder and launch the <code>.exe</code> files for the different tools <code>stereoproj</code>, <code>diffraction</code>, <code>kikuchi</code>,<code>misorientation</code>,<code>interface</code> and <code>crystal</code>.</p>"},{"location":"started/#from-python-windows-macos-linux","title":"From Python (Windows, macOS, Linux)","text":"<p>Pycotem is a collection of  Python scripts and thus can be ran directly from the source code. Python may already be installed on your OS (type <code>python</code> on your command prompt/terminal). If not, please refer to the python website for installing and downloading. Popular distributions as Anaconda can be an option. Pycotem is part of the python package index (PyPi) and thus can be installed using the package installer for Python (pip), which should be installed with the Python distribution.</p> <p>Note</p> <p>Consider that it is often recommended to install packages in a virtual environnement to avoid breaking dependancies for other scripts. Please refer to the specific documentation, for instance regarding the <code>virtualenv</code> package. The following procedure can be applied to install a virtual environnement in a <code>pycotem</code> folder (cross-platform): <pre><code>pip install virtualenv \n</code></pre> or <pre><code>pip3 install virtualenv\n</code></pre> then</p> <p><pre><code>virtualenv path_to_your_folder/pycotem\ncd path_to_your_folder/pycotem\nsource bin/activate\n</code></pre> then pycotem can be installed and ran (see below) <code>deactivate</code> to logout from your environnement. Delete the <code>pycotem</code> folder to uninstall it.</p>"},{"location":"started/#prerequisites","title":"Prerequisites","text":"<p>Pycotem relies on Python 3 using numpy, pillow and matplotlib.  GUI relies on pyqt5. </p> <p>Configurations successfully tested</p> <p>python = 3.9.5, numpy = 1.21.4, matplotlib = 3.5.0, pillow = 7.0.0, pyqt = 5.14.1</p> <p>python = 3.10.2, numpy = 1.25.2, matplotlib = 3.7.2, pillow = 10.0.0, pyqt = 5.19.9</p>"},{"location":"started/#installing-and-running","title":"Installing and running","text":"<ul> <li>pycotem and dependancies can be installed using the <code>pip</code> commands: </li> </ul> <pre><code>pip install pycotem\npip install matplotlib\npip install pyqt5\n</code></pre> <p>Run the packages with <pre><code>python -m pycotem.xxxx\n</code></pre> where <code>xxxx</code> is one of the tool <code>stereoproj</code>, <code>diffraction</code>, <code>kikuchi</code>,<code>misorientation</code>,<code>interface</code> and <code>crystal</code>.</p>"},{"location":"started/#updating","title":"Updating","text":"<ul> <li>Use <code>pip install --upgrade pycotem</code></li> </ul>"},{"location":"started/#examples","title":"Examples","text":"<p>Image files and setting parameters for testing <code>diffraction</code>, <code>interface</code> and <code>kikuchi</code> can be found here</p>"},{"location":"stereoproj/","title":"StereoProj","text":"<p>Stereoproj allows to work with stereographic projections.</p>"},{"location":"stereoproj/#stereographic-projections","title":"Stereographic projections","text":"<p>A stereographic projection is a type of projection that maps a unit sphere onto a plane. It is a conformal projection, which means it preserves angles. Stereographic projections are often used for practical reason in crystallography to display symmetry elements. This is an essential tool for electron microscopists who want to analyze microstructures. Traditionally, projections are drawn by hand with the help of a Wulff net.</p>"},{"location":"stereoproj/#construction","title":"Construction","text":"<p>Let's consider the south pole S of a sphere lying in a (x,y,z) coordinate system. A point M in the upper hemisphere of the sphere can be projected on M' defined as the intersection between the line MS and the equatorial plane, i.e the plane that cuts the sphere at z=0. </p> <p></p> <p>Projection convention</p> <p>From a geometrical construction, points in the lower hemisphere (z negative) do not appear. They can alternatively be projected on the plane from the north pole instead. Opposite 3D directions, will then have opposite coordinates in the projection plane. In Stereoproj,  we choose to discard points from the lower hemisphere.</p> <p>From this construction, it results several important features:</p> <ul> <li> <p>3D directions (x_0,y_0,z_0) are projected into points of coordinates (X_0,Y_0)  such as X_0= \\frac{x_0}{1+z_0} \\ Y_0=\\frac{y_0}{1+z_0}.</p> </li> <li> <p>circles on the sphere, which correspond to 3D planes (full circles) or cones (smaller circles), are projected as portion or full circles.</p> </li> <li> <p>the north/south pole is located at the center of the stereographic projection.</p> </li> <li> <p>the equatorial plane is projected as a great circle that bounds the stereograpic projection.</p> </li> <li> <p>any 3D direction can be defined by two angles <sup>1</sup> that we can choose as their inclination angle \\eta with respect to the Oy direction and tilt angle \\alpha with respect to the reference equatorial plane.</p> </li> </ul>"},{"location":"stereoproj/#the-wulff-net","title":"The Wulff net","text":"<p>The Wulff net results from the projection of equally distributed planes called meridians and parallels <sup>2</sup>. The first ones correspond to planes of a given tilt angle, the second correspond to planes of a given inclination angle <sup>3</sup>. In Stereoproj, meridians and parallels can be displayed and are spaced every 2\u00b0 with thicker lines every 10\u00b0.</p> <p></p> <p>Meridians and parallels forming a Wulff net. Definition of the inclination and tilt angles.</p>"},{"location":"stereoproj/#euler-angles","title":"Euler angles","text":"<p>The orientation of a crystal can be set by 3 angles. Indeed, given a direction, defined by two angles, the orientation can be fixed after rotating along this direction. A second standard definition of orientation is set by the Euler angles (\\varphi_1, \\phi, \\varphi_2). In crystallography, it is traditionally adopted, according to Bunge, that it corresponds to:</p> <ol> <li> <p>a rotation along the z of  axis \\varphi_1</p> </li> <li> <p>a rotation along x' of \\phi </p> </li> <li> <p>a rotation along z' of \\varphi_2. </p> </li> </ol> <p>In the example below: (\\varphi_1,\\phi,\\varphi_2)=(-80,40,30)</p> <p></p> <p>Definition of the Euler angles, represented on the stereographic projection and in 3D. Points on the projections indicate the x,y,z directions. </p> <p>Rotation matrices and Euler angles </p> <p>The orientation is defined by a rotation matrix that links the reference frame (x,y,z) to the crystal frame (x',y',z') by composing the 3 rotations. In the example shown, it was considered that the rotations operate sequentially in a moving frame: they are called intrinsic. </p> <p>This definition is however not convenient for working with rotation matrices as the rotation axes move in the reference frame. So, we can define the Euler angles from extrinsic rotations, i.e. rotations that operate in the fixed reference frame (x,y,z), in the way presented in the figure below for (\\varphi_1,\\phi,\\varphi_2)=(-80,40,30). </p> <p></p> <p>This corresponds to: a rotation along z of an angle \\varphi_2, a rotation along x of \\phi and a rotation along z of \\varphi_1, i.e. <sup>5</sup>: </p> <p>$$ R=R_z(\\varphi_1)R_x(\\phi)R_z(\\varphi_2) $$ where R_z(a) and R_x(a) are the rotation matrices along x and z axis of an angle a. Inversely, knowing the rotation matrix, the Euler angles can be determined:  $$ \\varphi_1 = \\arctan(R_{02}/R_{12}), \\phi = \\arccos(R_{22}), \\varphi_2 = \\arctan(R_{20}/R_{21}) $$ However, when \\phi=0 (\\pi), the angles \\varphi_2 and \\varphi_1 are not defined independently, i.e. because they share a common rotation axis. This phenomena is known as gimbal lock  and can be resolved by setting \\phi = 0, \\varphi_1 = 0 and \\varphi_2 = \\arctan(R_{10}/R_{00})</p>"},{"location":"stereoproj/#coordinate-systems","title":"Coordinate systems","text":"<p>Microscope coordinate system is defined by the axes (x,y,z) as shown in the figure below. The y axis corresponds to the holder primary tilt axis called \\alpha-tilt axis. The x direction corresponds to the secondary tilt axis called \\beta-tilt axis for a double tilt sample holder. The z direction is anti-parallel with the electron beam. It corresponds to the rotation axis for a tilt-rotation sample holder. By default, the rotation angles are taken positive in the clockwise sense, i.e. right handed.</p> <p></p> <p>The sample, and then the crystal, can be rotated around the tilt axes. Rotation steps are 5\u00b0 by default. The value of rotation angle are indicated. The sense of rotation can be changed by ticking the <code>AC</code> (anti-clockwise) box. </p> <p></p> <p>The <code>Reset</code> button allows to reset the values displayed.</p> <p>When the <code>Lock Axes</code> box is checked, the x and z axes are now fixed with the sample, in order to mimic the behavior of double tilt and tilt-rotation holder.</p> <p>Rotation in double tilt </p> <p>When the axes are fixed in the microscope frame (x,y,z), the rotation order matters. However, when the x axis is fixed in the sample frame and y fixed in the microscope frame, the two operations are commutative. In terms of rotation matrices, we have: </p>  R_y(\\alpha)R_x(\\beta)=R_u(\\beta)R_y(\\alpha) \\\\ u=R_y(\\alpha)  [1,0,0]~^T  <p>Same conclusions hold for tilt-rotation holder.</p> <p></p> <p>Top: rotation with fixed rotation axes, Bottom: rotation with a fixed y tilt and moving x tilt. Red and blue paths represent a switch in the tilt order.</p> <p>Crystallographic feature analyses are carried out in a TEM using both diffraction and image mode. When the electrons passing through the specimen are focused in the back focal plane of the objective lens, they form a diffraction pattern which can be magnified in the projection plane where the pattern is recorded. Conversely, an image is formed in the first image plane of the objective lens, which can also be magnified by the projection lenses. To switch from image to diffraction mode, the power of the objective lens has to be modified which induces an image rotation. To enlarge the pattern or the image, the effect of intermediate and projection lenses may also introduce rotations. For this reason, the holder coordinate system does not correspond to the coordinate system as viewed in the recorded image or diffraction patterns. Users need thus to determine the relation between the two.</p> <p></p> <p>In image mode, the position of the \\alpha-tilt axis with respect to the Y axis, represented by an angle \\delta, can be determined by pushing or pulling on the holder and recording the motion of features on the image.</p> <p>In diffraction mode, the position of the \\alpha-tilt axis with respect to the Y axis, represented by an angle \\xi, can be determined by rotating the crystal and recording the displacement of the Kikuchi bands, which will be perpendicular to the rotation axis <sup>4</sup>.</p> <p>180\u00b0 rotation</p> <p>Because images and diffraction patterns are naturally inverted because of the objective lens, there usually exists a 180\u00b0 rotation between image and diffraction modes. In some cases, this extra rotation needs to be taken into account, i.e. when we care about (h,k,l) or (\\bar{h},\\bar{k},\\bar{l}). This can be solved by inspecting the sense of displacement of the Kikuchi lines with respect to the tilt angle, or by inspecting how the image is inverted or not in diffraction mode, compared to image mode, when under or over-focusing the diffraction lens. A 180\u00b0 rotation exists if the image seen in the transmitted beam in diffraction mode is rotated when under-focusing the diffraction lens.</p> <p>Because it is easier to navigate in the stereographic projection when knowing either the angle \\delta, in reciprocal space or \\xi in direct space, the rotation angle in image and diffraction mode can be indicated in the <code>diff alpha/y-angle</code> and <code>image alpha/y angle</code> fields. Tick the <code>img/diff</code> box to switch to image mode. When the view is updated, the tilting axes (and Wulff net) are rotated accordingly along the z axis as illustrated in the picture below. </p> <p></p> <p>Note</p> <p>Note that the Euler angles are always defined in the microscope coordinates, which is now rotated. Rotation along the \\alpha, \\beta and \\theta axes will now be updated. The diffraction patterns and Kikuchi bands are plotted owing the rotation indicated in the <code>diff alpha/y_angle</code> entry.</p>"},{"location":"stereoproj/#interface","title":"Interface","text":"<p>The interface is composed of a top menu bar, the plotting area and the plotting panel. Zoom and pan are available in the plotting area. Click on the <code>update/reset view</code> button to restore the full view.</p> <p></p>"},{"location":"stereoproj/#plotting-procedure","title":"Plotting procedure","text":""},{"location":"stereoproj/#setting-up-the-crystal","title":"Setting up the crystal","text":"<p>Stereographic projection reflects the symmetry of a given lattice system which depends on the lattice parameters a,b,c and the angles \\alpha, \\beta and \\gamma of the cell.  a,b,c and \\alpha, \\beta, \\gamma can be set up in the Crystal parameters.</p> <p></p> <p>Info</p> <p>A crystal direction expressed by their Miller indices are related to cartesian coordinates, in the crystal frame, by:</p>   \\begin{bmatrix}x\\\\ y \\\\ z \\end{bmatrix}=D \\begin{bmatrix}u \\\\ v \\\\ w \\end{bmatrix}  <p>with</p>  D= \\begin{pmatrix}  a &amp; b \\cos \\gamma &amp; c \\cos \\beta \\\\  0 &amp; b \\sin \\gamma &amp;  c (\\cos \\alpha - \\cos \\beta  \\cos \\gamma)/ \\sin \\gamma\\\\  0 &amp; 0 &amp; V/(a b \\sin \\gamma)  \\end{pmatrix}  <p>V being the crystal volume V = a b c \\sqrt {1 - \\cos^2\\alpha - \\cos^2 \\beta - \\cos^2 \\gamma + 2 \\cos \\alpha \\cos \\beta \\cos \\gamma }</p> <p>Inversely in the reciprocal space, poles, i.e. normal to planes are related by:</p>   \\begin{pmatrix}x\\\\ y \\\\ z \\end{pmatrix}=D^\\ast \\begin{pmatrix}h \\\\ k \\\\ l \\end{pmatrix}  <p>with D^\\ast= (D^{-1}) ~^T.</p> <p>The metric of the crystal G allows to measure distance in direct and reciprocal space. The inter-reticular spacing for a plane (h,k,l) for instance is given by: </p>  d_{hkl}=\\frac{1}{d^\\ast_{hkl}}=\\frac{1}{\\sqrt{(h \\ k \\ l)G^\\star (h \\ k \\ l)~^T}}  <p>with </p>   G^\\ast=D^\\ast~^T D^\\ast  <p>Change the number of pole/direction drawn by increasing or decreasing the value of <code>d</code> and/or by changing the <code>maximum indices</code> first value (see simple-labels for the second value below).</p> <p></p> <p>Crystal structure can be imported from the <code>structure</code> menu. This menu can be populated by adding structures in the <code>structure.txt</code> files following the template:</p> <pre><code>Name a(A) b(A) c(A) alpha beta gamma space group\n</code></pre> <p>The space group is defined in the <code>space_group.txt</code> file following the scheme:</p> <pre><code>Name\nAtom name1 x1 y1 z1\nAtom name1 x2 y2 z2\n...\nAtom name2 x3 y3 z3\n</code></pre> <p>Additionally, atoms need to be defined in the <code>scattering.txt</code> file (see diffraction for more details).</p> <p>From diffraction, crystals with different space groups (even with the same lattice system) present diffraction vectors, i.e. in the reciprocal space, with different intensities. Filling the space group field and ticking the <code>reciprocal indices</code> box will allow to plot poles with sizes proportional to their intensity (see the diffraction page for more details).</p> <p></p> <p>Example for a TiAl crystal</p>"},{"location":"stereoproj/#from-euler-angles","title":"From Euler angles","text":"<p>Stereographic projections can be drawn from the 3 Euler angles. The angles can be read at all time after rotation operations. \\alpha-tilt and inclination angles can be read from the mouse position on  the Wulff net.</p> <p></p>"},{"location":"stereoproj/#from-a-zone-axis","title":"From a zone axis","text":"<p>If a zone axis can be assigned, the orientation can be retrieved in the following way:</p> <ol> <li> <p>determine \\langle u, v, w\\rangle indices of the zone axis <sup>6</sup> and identify one diffraction vector (see diffraction)</p> </li> <li> <p>set first tilt angles \\alpha, \\beta, \\theta (comma separated) to 0,0,0 and inclination \\eta to 0</p> </li> <li> <p>tick the <code>ZA</code> box</p> </li> <li> <p>plot and then rotate around <code>z</code> (or <code>Rotation along g</code>) in order to bring the diffraction vector at the correct inclination in the projection reference frame. Note this angle.</p> </li> <li> <p>set \\alpha, \\beta, \\theta to the values where the zone axis was recorded. Indicate \\eta with the retrieved value.</p> </li> </ol> <p></p>"},{"location":"stereoproj/#from-a-diffraction-vector","title":"From a diffraction vector","text":"<p>The orientation can be alternatively set the following way: </p> <ol> <li> <p>choose a diffraction vector (h,k,l) (see diffraction to determine it)</p> </li> <li> <p>set its inclination \\eta and tilt angles \\alpha, \\beta, \\theta (comma separated)</p> </li> <li> <p>adjust a second diffraction vector by rotating around the first vector</p> </li> </ol> <p></p> <p>Multiple tilting axes</p> <p>When considering a diffraction vector obtained after double tilt (\\alpha and \\beta) or after tilt-rotation (\\alpha, \\theta), the diffraction vector should be placed on the stereographic projection taking into account the fact that the \\beta (or \\theta) -tilt axis moves with the holder while \\alpha-tilt is fixed. For instance, if the (1,1,1) diffraction vector is recorded at (\\alpha,\\beta,\\theta)=(10,-20,0) with an inclination of \\eta=40, the diffraction is placed such that after rotating first by \\beta=-20 and second by \\alpha=10 it forms an angle \\eta=40 with the y direction on the diffraction pattern (owing that there is no rotation between the \\alpha tilt axis and the y direction). This means that in the sample frame, the diffraction vector coordinates are, starting from [0,1,0], in the direction [x,y,z], given by: a rotation of -\\eta then a rotation of -\\alpha and finally a rotation of -\\beta:</p>  [x,y,z]^T=R_x(-\\beta)R_y(-\\alpha)R_z(-\\eta)[0,1,0]^T  <p></p>"},{"location":"stereoproj/#plotting-polesplanescones","title":"Plotting poles/planes/cones","text":"<p>Poles (or directions) can be additionally plotted. <code>Add</code> a pole or all the symmetric ones by pressing <code>Symmetry</code> after entering the indices comma separated. A <code>Plane</code> or all their symmetric,<code>Sym Plane</code> can be drawn. A <code>Cone</code> can be drawn by specifying its aperture angle.</p> <p></p> <p>Iso-schmid factor lines can be plotted by specifying the plane in the pole/plane field and by pressing the <code>Schmid</code> button. The straining axis is here parallel to the \\alpha-tilt axis. Further explanation will be given here.</p> <p></p> <p>Finally inter-reticular distances are given by entering a plane normal on the pole/plane field and by pressing <code>dhkl</code> button. The value appears in a field near the button.</p>"},{"location":"stereoproj/#simple-labels","title":"Simple labels","text":"<p>Simplified labels can be drawn if the <code>simple label</code> box is ticked. By default, simple labels are searched within an angular range of 1 degree, but it can be changed in filling the simple label field. The maximum indices for the search depend on the second values of the <code>max indices</code> value. By default, it is set to 20 but can be increased (need to replot). Keep in mind that large values will slow down plotting and searching.</p> <p></p>"},{"location":"stereoproj/#layout","title":"Layout","text":"<p>Several layout options have been already discussed. Additional ones are presented here. </p> <ul> <li> <p>Colors can be set for poles or planes plotted.  </p> </li> <li> <p>Open symbols can be drawn by ticking the <code>open/filled</code> box (default are filled symbols).</p> </li> <li> <p>Wulff net can be drawn if the <code>Wulff net</code> box is ticked.</p> </li> <li> <p>Marker size and text size can be indicated in the corresponding fields.</p> </li> <li> <p>[uvw] can be displayed by ticking the <code>uvw</code> box and replotting.</p> </li> </ul> <p></p> <ul> <li>By default, indices are plotted up to <code>max indices</code> = 3 if the <code>labels</code> box is ticked and the labels field is left empty. This limitation avoids slow plotting. To draw a large number of poles/directions with a limited number of indices, simply indicate the maximum plotting indices, in the labels field (example is shown below for <code>max indices</code> = 6 and <code>labels</code> = 1)</li> </ul> <p></p> <p>For hexagonal structure, the <code>hexa</code> box can be selected to let the 4 indices notations.</p> <p>Hexagonal structure and notation</p> <p>For hexagonal structure, it is more convenient to represent directions or planes using a basis with 4 integer indices than using the conventional cartesian basis. This basis is composed of the 3 vectors \\vec{a}_i separated by 120\u00b0 angles and the \\vec{c} perpendicular to the \\vec{a}_i vectors. Hence any directions is given by [uvtw] with t=-u-v. In the reciprocal space, a plane is represented by (hkil) with i=-h-k.</p> <p>Transforming indices from the 3 (HKL) indices to 4 (hkil) indices is straightforward for planes as H=h, K=k, L=l. For directions, [UVW] we have the relationships, U=2u+v, V=2v+u and W=w or u=1/3(2U-V), v=1/3(2V-U) and w=W.</p> <p>Note that with the four indices notations, directions are perpendicular to plane normals (i.e. contain in a plane) if (hkil)\\cdot[uvtw]=0 as shown for instance below.</p> <p>Note that for Euler angles convention, \\langle a \\rangle is parallel to x and \\langle c \\rangle is parallel to z at (0,0,0).</p> <p></p> <p>Except <code>uvw</code> and colors, the above features can be updated by clicking the <code>Update/Reset view</code> button.</p> <p>click a pole/directions</p> <p>By right clicking on the stereographic projection, poles or directions (if <code>uvw</code> is ticked) will be displayed. Make <code>Ctrl+z</code> to remove the last click.</p>"},{"location":"stereoproj/#additional-features","title":"Additional features","text":"<p>They are accessible from the menu bar.</p>"},{"location":"stereoproj/#save","title":"Save","text":"<p>Stereographic plots can be saved as image with <code>png</code> format.</p>"},{"location":"stereoproj/#angle","title":"Angle","text":"<p>Angles between two poles (or two directions if the <code>uvw</code> button is ticked) can be computed by entering them in the field <code>n1</code> and <code>n2</code> (comma separated). The result appears after pressing <code>OK</code>.  <code>Cancel</code> to quit.</p> <p></p>"},{"location":"stereoproj/#schmid-factor","title":"Schmid factor","text":"<p>Schmid factors can be computed by entering both \\vec{b} (as a direction), plane normal \\vec{n} and straining axis \\vec{T}. \\vec{T} should be expressed in the microscope coordinate system.</p> <p></p> <p>After pressing <code>OK</code>, the Schmid factor appears below the the T field. In the box below appear all possible slip systems <code>n</code>, <code>b</code>, with their Schmid factor values <code>s</code>.</p> <p> Schimd factor</p> <p>For a crystal strained along a tensile axis \\vec{T} with a stress \\sigma, dislocation slip on plane \\vec{n} with the Burgers vector \\vec{b} will happen if the resolved shear stress on the plane rises a critical value, i.e. $$  \\tau_c=\\sigma \\cos {(\\vec{n},\\vec{T})} \\cos{(\\vec{b},\\vec{T})} $$ Thus, the most favored slip system should be the one with the highest Schmid factor i.e., m=\\cos{(\\vec{n},\\vec{T})} \\cos{(\\vec{b},\\vec{T})}. For dislocation glide, m should range between 0 and 0.5 </p>"},{"location":"stereoproj/#xyz-directions","title":"xyz directions","text":"<p>x,y,z directions can be determined in the <code>calculate xyz directions</code> menu. Simply press <code>update</code>. The values indicated correspond to poles (i.e. in reciprocal space). Copy, paste in the <code>pole/plane</code> field and <code>Add</code> to plot. To get directions, use the <code>hkl&lt;&gt;uvw</code> menu. Press <code>To uvw</code> or <code>To hkl</code> to make the conversion. Then, copy and paste the result in the same way except <code>uvw</code> box need to be ticked.</p> <p></p>"},{"location":"stereoproj/#list","title":"List","text":"<p>A list of plotted poles/directions can be  displayed using the <code>show list poles/directions</code> menu. When the <code>Update list</code> button is pressed the list is printed in a table showing in columns:</p> <ul> <li> <p>indices</p> </li> <li> <p>a sign <code>o</code> for plotted or <code>x</code> for hidden</p> </li> <li> <p><code>hkl</code> for a pole and <code>uvw</code> for a direction </p> </li> </ul> <p>Poles/directions can be hidden or shown by selecting the corresponding rows and by clicking on <code>Add/Remove selected</code> button. Then the signs <code>o</code> or <code>x</code> change.</p> <p>Planes or cones of the given poles/directions will be hidden/shown if the <code>plane</code> or <code>cone</code> box is checked. </p> <p>If the list is updated, then the hidden poles/directions are deleted.</p> <p>An easier navigation in the crystal space can be achieved by determining the tilt sequence to reach either a given two-beam condition or a zone axis. The angles are indicated in the last table column when pressing the <code>Compute tilt</code> button.</p> <p>If the <code>ZA</code> (zone axis) button is ticked, the \\alpha-tilt and either \\beta tilt or \\theta tilt needed to reach the corresponding zone axis are computed. The corresponding \\beta or \\theta tilt button needs to be selected.</p> <p>If the <code>ZA</code> button is not selected, the \\alpha tilt angle needed to have a given pole/direction perpendicular to the electron beam (may correspond to a two-beam condition) can be computed for a given \\beta or \\theta tilt angle.</p> <p></p>"},{"location":"stereoproj/#width","title":"Width","text":"<p>Using <code>calculate apparent width</code> menu allows to plot the apparent width and apparent trace directions of an interface, when the sample is tilted along the \\alpha-tilt axis from -40\u00b0 to 40\u00b0. More details on the method will be given in interface.</p> <p>First, indicate the <code>plane</code>. The foil surface may be indicated if the box right to the box is ticked. The sample <code>thickness</code> may be indicated in  nm if the box is checked . If not, the apparent width is normalized by the interface width d. The <code>trace dir.</code> can be plotted if the box is checked with a blue overlay. Note that if several plots are made, which can be sometimes convenient, they will  be superimposed. To erase the plots, click the <code>clear</code> button.</p> <p></p>"},{"location":"stereoproj/#intersections","title":"Intersections","text":"<p>Several intersections can be calculated through the <code>calculate intersections</code> menu. In the different cases, results will appear by pressing <code>OK</code>. Results shown correspond to poles except if the <code>directions</code> box is ticked.</p> <ul> <li> <p>intersections between two planes <code>n1</code> and <code>n2</code>.</p> </li> <li> <p>intersections between a plane <code>n1</code> and the direction in the (x,y) plane making a given angle with the Oy direction indicated by an <code>angle</code> (\u00b0).</p> </li> <li> <p>intersections between a plane <code>n1</code> and a cone <code>c</code> of a given angle aperture indicated by the <code>inclination angle</code> (\u00b0). If no solution, <code>nan</code> will appear.</p> </li> </ul> <p></p>"},{"location":"stereoproj/#diffraction","title":"Diffraction","text":"<p>The <code>plot Kikuchi lines and diffraction pattern</code> menu allows simple diffraction features drawing. They can be accessed through the button <code>Diffraction</code> or <code>Kikuchi</code>, after setting a crystal and an orientation (see above).</p>"},{"location":"stereoproj/#diffraction-pattern","title":"Diffraction pattern","text":"<p>The following parameters are needed:</p> <ul> <li> <p>Acceleration voltage: <code>E(kv)</code></p> </li> <li> <p><code>Aperture angle</code> determining the extension in (\u00b0) viewed in the reciprocal space</p> </li> <li> <p><code>Max indices</code> determining the extension of the reciprocal space calculated</p> </li> <li> <p><code>Brightness change</code> (in %) offsetting image intensity. Allow the visualization of low intensity spots</p> </li> <li> <p><code>Thickness</code> is the sample thickness in nm</p> </li> <li> <p><code>Excitation error</code> in 1/nm</p> </li> </ul> <p>Click on <code>Diff calc.</code> button to compute the intensity of every g-vector (see diffraction for more details)</p> <p>Click then on <code>OK</code> button to draw the diffraction pattern. Update the drawing by clicking <code>OK</code> if the orientation is changed.</p> <p>Tick the <code>label</code> box to show indices (for hexagonal crystal, 3 indices are used).</p> <p>Diffraction pattern simulation</p> <p>When an incoming electron wave of wavelength \\lambda and a wave vector \\vec{k} hits a crystal plane, it will be elastically diffracted in a direction given by the wave vector \\vec{k}_g, with the relation: $$ \\vec{k}_g=\\vec{k}+\\vec{g} $$ or equivalently $$ 2d\\sin{\\theta_B}=\\lambda $$ where \\theta_B is the Bragg angle and d the interplanar distance defined by the \\vec{g} vector. </p> <p>When the crystal is tilted away from the Bragg condition, diffraction ceases but not abruptly. To determine the decrease of the intensity, we need to define the vector \\vec{s} which norm is called the excitation error, as shown below.</p> <p></p> <p>Two beam calculations show that:</p>  I = \\frac{\\pi^2}{\\xi^2}\\frac{\\sin^2{(\\pi s_e t)}}{( \\pi s_e )^2}  <p>where t is the crystal thickness, \\xi the extinction distance, which indicates how the diffracted electron wave oscillates through the crystal, and s_e= \\sqrt{(s^2 + 1/\\xi^2)} the effective excitation error.   </p> <p>For a given orientation, the excitation error s can be computed for every possible diffraction vectors, and then their corresponding intensity.</p> <p>Absorption was in addition taken into account. It implies taking a second extinction distance \\xi'_g defined from the imaginary part of the crystal potential. Here \\xi'_g is fixed chosen as \\xi'_g/\\xi_g = 10.</p> <p>Note that all the above approximations are not intended to reproduce the correct intensities for multiple beam as in zone axes but provide a first guess.</p> <p></p>"},{"location":"stereoproj/#kikuchi-lines","title":"Kikuchi lines","text":"<p>Kikuchi lines results from inelastic scattering in the sample and will be more discussed in the Kikuchi section. They can be plotted by selecting <code>Kikuchi</code> button.</p> <p>The following parameters are needed:</p> <ul> <li> <p>Acceleration voltage: <code>E(kv)</code></p> </li> <li> <p><code>Aperture angle</code> determining the extension in (\u00b0) viewed in the reciprocal space</p> </li> <li> <p><code>Max indices</code> determining the number of bands calculated</p> </li> </ul> <p>Click on <code>Diff calc.</code> button to compute the intensity of the band.</p> <p>Click then on <code>OK</code> button to draw the Kikuchi pattern. Update the drawing by clicking <code>OK</code> if the orientation is changed.</p> <p>Change the <code>Aperture angle</code> to view a larger pattern.</p> <p>Tick the <code>label</code> box to show indices (for hexagonal crystal, 3 indices are used).</p> <p>Kikuchi band formation</p> <p>When inelastically scattered electrons are in Bragg conditions, they will diffract, but because they can come from different directions, they will be scattered in a cone around \\vec{g}. As there are two diffraction directions (\\pm \\vec{g}), two cones will form, one being brighter and the other darker than the background. When hitting the observation screen, they will form pairs of lines which separation width is proportional to the inter-planar distance d. Their projection is called gnomonic, i.e. a point of coordinate (x,y,z) will become (X,Y) with X = x/z and Y = y / z.</p> <p>Here, to mimic the kinematical approximation, the line widths are proportional to the intensity of the corresponding diffraction vector and the intensity difference between the lines are not taken into account.</p> <p></p>"},{"location":"stereoproj/#pole-and-inverse-pole-figures","title":"Pole and inverse pole figures","text":"<p>Pole figures (PF) represent given (equivalent) poles in the microscope coordinates. At variance, inverse pole figures (IPF) are used to represent a given direction in the crystal coordinate system. As they reflect the crystal structure, IPF are drawn in the minimal area of the stereographic projection, called the standard triangle, where all equivalent poles or crystal directions can be brought back by a point group symmetry operation of the crystal. Hence, seven different standard triangles corresponding to the seven crystal systems have to be considered. For cubic crystals for instance, the standard triangle, is defined by the (010), (\\bar{1}01) and (\\bar{1}10) planes and the [001], [111] and [101] directions as vertices. </p> <p>To draw PF and IPF:</p> <ul> <li> <p>use the <code>PF/IPF</code> menu and select <code>Draw PF/IPF</code>.</p> </li> <li> <p>once the crystal is selected and plotted in the main window, press <code>Draw Standard Triangle</code>.</p> </li> </ul> <p>For IPF:</p> <ul> <li> <p>to add directions, tick the <code>uvw</code> button in the main window. Untick to draw poles.</p> </li> <li> <p>Fill the pole entry and click <code>Add pole</code>. The pole/direction or an equivalent one is plotted with the selected color.</p> </li> <li> <p>Untick the <code>Show labels</code> button and press <code>Refresh view</code> to hide the labels. Label sizes can be changed through the <code>Text size</code> entry in the main window and updated after pressing <code>Update/Reset view</code> button and <code>Refresh view</code>.</p> </li> <li> <p>Pole/directions are stored in the drop down list. Select one and  click <code>Remove pole</code> to remove them. </p> </li> <li> <p>Given planes can be drawn using the plane drop down list and the <code>Add plane</code>, <code>Remove plane</code> buttons.</p> </li> <li> <p>Zoom and pan using the toolbar. <code>Refresh view</code> to reset. </p> </li> <li> <p>To draw pole figure given the current orientation \\varphi_1, \\phi, \\varphi_2 tick the <code>curr. orientation</code> box and click <code>plot IPF</code>. The direction (x,y,z) should be indicated in the left box. By default <code>1,0,0</code> thus indicates the x direction.</p> </li> </ul> <p></p> <p>For PF:</p> <ul> <li>For a given orientation, tick the <code>curr. orientation</code> box and click <code>plot PF</code>. The pole {h,k,l} should be indicated in the left box. By default <code>1,0,0</code> thus indicates the {1,0,0} poles.</li> </ul> <p>Import data to plot IPF and PF for different orientations (cloud points):</p> <ul> <li><code>Import data</code> from <code>.txt</code> file with the following scheme</li> </ul> <pre><code># Any comments\n\nphi1,phi,phi2 \n...\n</code></pre> <ul> <li> <p>After import the file name appears below. Note that the <code>curr. orientation</code> should not be ticked.</p> </li> <li> <p>plot points with <code>plotPF</code> and <code>plotIPF</code> buttons.</p> </li> </ul> <p></p> <ol> <li> <p>In the reference frame, the vector (0,1,0) is first rotated along z by an angle \\eta and then along y by an angle \\alpha, the rotation axes being fixed. The definition proposed here differs from the usual spherical coordinates that refers on azimuth and elevation angles.\u00a0\u21a9</p> </li> <li> <p>These names usually refer in geography  to lines of given longitude and latitude connecting north and south poles. Here the lines connect east and west poles of the sphere.\u00a0\u21a9</p> </li> <li> <p>As meridians pass by two poles, they correspond to full circles on the sphere. Contrary parallels (except the equator) correspond to smaller circles on the sphere. Meridians result then from the intersection of planes with the sphere and parallels from the intersection of cones of given aperture.\u00a0\u21a9</p> </li> <li> <p>Note that the Kikuchi bands move in the opposite directions than the corresponding planes in the stereographic projection. It is due to the fact that the electron beam points toward the lower hemisphere of the stereogram.\u00a0\u21a9</p> </li> <li> <p>We consider active rotations and rotation matrix acting by pre-multiplying column vectors.\u00a0\u21a9</p> </li> <li> <p>be aware that zone axis indices are given in the direct space.\u00a0\u21a9</p> </li> </ol>"}]}