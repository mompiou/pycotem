
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.0.3">
    
    
      
        <title>Interface - pycotem</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.62128196.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.9204c3b2.min.css">
        
          
          
          <meta name="theme-color" content="#7e56c2">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Asap:300,400,400i,700%7C&display=fallback">
        <style>:root{--md-text-font:"Asap";--md-code-font:""}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>function __md_scope(e,t,_){return new URL(_||(t===localStorage?"..":".."),location).pathname+"."+e}function __md_get(e,t=localStorage,_){return JSON.parse(t.getItem(__md_scope(e,t,_)))}function __md_set(e,t,_=localStorage,o){try{_.setItem(__md_scope(e,_,o),JSON.stringify(t))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="pycotem" class="md-header__button md-logo" aria-label="pycotem" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pycotem
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Interface
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/mompiou/pycotem" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    mompiou/pycotem
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="pycotem" class="md-nav__button md-logo" aria-label="pycotem" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
<!--    pycotem-->
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/mompiou/pycotem" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    mompiou/pycotem
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../diffraction/" class="md-nav__link">
        Diffraction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../kikuchi/" class="md-nav__link">
        Kikuchi
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../stereoproj/" class="md-nav__link">
        StereoProj
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Interface
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Interface
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#line-determination" class="md-nav__link">
    Line determination
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure" class="md-nav__link">
    Procedure
  </a>
  
    <nav class="md-nav" aria-label="Procedure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings" class="md-nav__link">
    Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-data" class="md-nav__link">
    Getting data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drawing" class="md-nav__link">
    Drawing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measuring" class="md-nav__link">
    Measuring
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importexport-data" class="md-nav__link">
    Import/Export data
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../misorientation/" class="md-nav__link">
        Misorientation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../crystal/" class="md-nav__link">
        Crystal
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ressources/" class="md-nav__link">
        Further ressources
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contribute/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav" aria-label="Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#line-determination" class="md-nav__link">
    Line determination
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interface" class="md-nav__link">
    Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure" class="md-nav__link">
    Procedure
  </a>
  
    <nav class="md-nav" aria-label="Procedure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings" class="md-nav__link">
    Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-data" class="md-nav__link">
    Getting data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drawing" class="md-nav__link">
    Drawing
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#measuring" class="md-nav__link">
    Measuring
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importexport-data" class="md-nav__link">
    Import/Export data
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                

  <h1>Interface</h1>

<p><code>interface</code> allows to determine interface normal or direction from a set of images.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Determining an interface plane can be performed using a series of TEM images (usually in Bright Field) acquired during a tilting series. Here we show how to get a quantitative assessment of the interface normal.</p>
<p>In TEM, a plane interface of normal <span class="arithmatex"><span class="MathJax_Preview">\vec{n}</span><script type="math/tex">\vec{n}</script></span> appear as a projection in the viewing screen. For a given orientation determined by the beam direction <span class="arithmatex"><span class="MathJax_Preview">\vec{b}_e</span><script type="math/tex">\vec{b}_e</script></span> in the sample reference frame (noted with the subscript <span class="arithmatex"><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span>), the interface plane is fully described by the direction of the projected traces <span class="arithmatex"><span class="MathJax_Preview">\vec{t}_p</span><script type="math/tex">\vec{t}_p</script></span> that correspond to the intersection between the foil surface <span class="arithmatex"><span class="MathJax_Preview">\vec{s}</span><script type="math/tex">\vec{s}</script></span> and the plane. In the projected plane coordinates (noted with <span class="arithmatex"><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span>), the direction of the trace can be characterized by the azimuth angle <span class="arithmatex"><span class="MathJax_Preview">\eta</span><script type="math/tex">\eta</script></span> with the <span class="arithmatex"><span class="MathJax_Preview">y_P</span><script type="math/tex">y_P</script></span> direction. Note that because of the electron optics, the projected plane frame can be rotated with respect to the holder coordinate system (noted with <span class="arithmatex"><span class="MathJax_Preview">H</span><script type="math/tex">H</script></span>) along <span class="arithmatex"><span class="MathJax_Preview">z_P=z_H</span><script type="math/tex">z_P=z_H</script></span> (see this <a href="../stereoproj/#coordinate-systems">section</a>, for the definition of the holder coordinate system). </p>
<p>If the two surfaces are parallel the two projected traces are also parallel (fig. a). Thus, the width <span class="arithmatex"><span class="MathJax_Preview">w</span><script type="math/tex">w</script></span> between the two traces can be also measured. These data constitute the set <span class="arithmatex"><span class="MathJax_Preview">(\vec{b}_e, \eta ,w)</span><script type="math/tex">(\vec{b}_e, \eta ,w)</script></span>. If the surfaces are not parallel, the approach described below still works if a specific point <span class="arithmatex"><span class="MathJax_Preview">C</span><script type="math/tex">C</script></span> (projected on <span class="arithmatex"><span class="MathJax_Preview">H</span><script type="math/tex">H</script></span>) can be tracked (fig. b).</p>
<p><img alt="" src="../images/interface-schema.png" /></p>
<p>It can be shown that the apparent width <span class="arithmatex"><span class="MathJax_Preview">w</span><script type="math/tex">w</script></span> is given by:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
w= \frac{ \lvert d\vec{n} \cdot \vec{b}_e \rvert}{\sqrt{ 1- (\vec{b}_e \cdot \vec{t})^2}}
</div>
<script type="math/tex; mode=display">
w= \frac{ \lvert d\vec{n} \cdot \vec{b}_e \rvert}{\sqrt{ 1- (\vec{b}_e \cdot \vec{t})^2}}
</script>
</div>
<p>The unit normal vector <span class="arithmatex"><span class="MathJax_Preview">\vec{n}</span><script type="math/tex">\vec{n}</script></span> can be estimated following the two steps procedure:</p>
<ul>
<li>first solve <span class="arithmatex"><span class="MathJax_Preview">\vec{t}</span><script type="math/tex">\vec{t}</script></span> following the <span class="arithmatex"><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> equations:</li>
</ul>
<div class="arithmatex">
<div class="MathJax_Preview">
[\vec{b}_{e1} \times \vec{t}_{p1}, ..., \vec{b}_{em} \times \vec{t}_{pm} ]^T \cdot \vec{t} =0
</div>
<script type="math/tex; mode=display">
[\vec{b}_{e1} \times \vec{t}_{p1}, ..., \vec{b}_{em} \times \vec{t}_{pm} ]^T \cdot \vec{t} =0
</script>
</div>
<ul>
<li>then solve :</li>
</ul>
<div class="arithmatex">
<div class="MathJax_Preview">
\left[\begin{array}{c}
\vec{b}_{e1}^\mathrm{T} \\[2mm]
\vec{b}_{e2}^\mathrm{T} \\[2mm]
...\\
\vec{b}_{em}^\mathrm{T} \\[2mm]
\vec{t}^\mathrm{T}
\end{array}\right]
(d \vec{n})
=\left[\begin{array}{c} 
\mathrm{sgn}(1) w_1\sqrt{1- \left(\vec{b}_{e1} \cdot \vec{t} \right)^2}\\[0.5mm]
\mathrm{sgn}(2)w_2\sqrt{1- \left(\vec{b}_{e2} \cdot \vec{t} \right)^2}\\[0.5mm]
...\\
\mathrm{sgn}(m)w_m\sqrt{1- \left(\vec{b}_{em} \cdot \vec{t} \right)^2}\\[0.5mm]
0
\end{array}
\right]
</div>
<script type="math/tex; mode=display">
\left[\begin{array}{c}
\vec{b}_{e1}^\mathrm{T} \\[2mm]
\vec{b}_{e2}^\mathrm{T} \\[2mm]
...\\
\vec{b}_{em}^\mathrm{T} \\[2mm]
\vec{t}^\mathrm{T}
\end{array}\right]
(d \vec{n})
=\left[\begin{array}{c} 
\mathrm{sgn}(1) w_1\sqrt{1- \left(\vec{b}_{e1} \cdot \vec{t} \right)^2}\\[0.5mm]
\mathrm{sgn}(2)w_2\sqrt{1- \left(\vec{b}_{e2} \cdot \vec{t} \right)^2}\\[0.5mm]
...\\
\mathrm{sgn}(m)w_m\sqrt{1- \left(\vec{b}_{em} \cdot \vec{t} \right)^2}\\[0.5mm]
0
\end{array}
\right]
</script>
</div>
<p>the <span class="arithmatex"><span class="MathJax_Preview">\mathrm{sgn}(i)</span><script type="math/tex">\mathrm{sgn}(i)</script></span> here denotes that although the measure width is always positive, the dot product <span class="arithmatex"><span class="MathJax_Preview">\vec{b}_{ei} \cdot \vec{n}</span><script type="math/tex">\vec{b}_{ei} \cdot \vec{n}</script></span> can be negative.</p>
<p>The equation can be solved using the least square method, by varying <span class="arithmatex"><span class="MathJax_Preview">\mathrm{sgn}(i)</span><script type="math/tex">\mathrm{sgn}(i)</script></span>. The solution with the smallest residual is considered to be the correct one.</p>
<p>The inputs data used are for a double tilt holder using the convention described in <a href="../stereoproj/">stereoproj</a> derived from the position of the beam direction and apparent trace direction in the sample coordinates:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\vec{b}_{ei}=R_x(-\beta_i)R_y(-\alpha_i)[0,0,1]^T \\
\vec{t}_{pi}=R_z(-\eta)[0,1,0]^T
</div>
<script type="math/tex; mode=display">
\vec{b}_{ei}=R_x(-\beta_i)R_y(-\alpha_i)[0,0,1]^T \\
\vec{t}_{pi}=R_z(-\eta)[0,1,0]^T
</script>
</div>
<h3 id="line-determination">Line determination<a class="headerlink" href="#line-determination" title="Permanent link">&para;</a></h3>
<p>The same approach can be used to determine a linear feature <span class="arithmatex"><span class="MathJax_Preview">\vec{l}</span><script type="math/tex">\vec{l}</script></span> using the data sets <span class="arithmatex"><span class="MathJax_Preview">(\vec{b}_{ei}, \vec{l}_{pi}, l_i)</span><script type="math/tex">(\vec{b}_{ei}, \vec{l}_{pi}, l_i)</script></span> by solving:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
[\vec{b}_{ei} \times \vec{l}_{pi}, \vec{l}_{pi}]^T d\vec{l} =[0, sgn(i) l_i]^T
</div>
<script type="math/tex; mode=display">
[\vec{b}_{ei} \times \vec{l}_{pi}, \vec{l}_{pi}]^T d\vec{l} =[0, sgn(i) l_i]^T
</script>
</div>
<h2 id="interface">Interface<a class="headerlink" href="#interface" title="Permanent link">&para;</a></h2>
<p>The interface is composed of  a top bar menu, a plotting area to display images and a setting/results panel.</p>
<p><img alt="" src="../images/interface-interface.png" /></p>
<h2 id="procedure">Procedure<a class="headerlink" href="#procedure" title="Permanent link">&para;</a></h2>
<h3 id="settings">Settings<a class="headerlink" href="#settings" title="Permanent link">&para;</a></h3>
<p>The interface normal can be determined in the sample frame. If necessary it can be determined in the crystal frame if both the nature of crystal and its orientation are known. This requires to tick the <code>Use lattice coordinates</code> button.</p>
<p>Crystal structure can be imported from the <code>structure</code> menu or by filling the <span class="arithmatex"><span class="MathJax_Preview">a,b,c</span><script type="math/tex">a,b,c</script></span> and <span class="arithmatex"><span class="MathJax_Preview">\alpha,\beta,\gamma</span><script type="math/tex">\alpha,\beta,\gamma</script></span> fields. </p>
<p><strong>Microscope</strong> calibration need to be set to get correct scaling when the apparent widths <span class="arithmatex"><span class="MathJax_Preview">w</span><script type="math/tex">w</script></span> are measured. If the box is set to <code>uncalibrated</code> measured will be performed in pixels. Calibrations can be set in the <code>microscope.txt</code> file with the following scheme:</p>
<div class="highlight"><pre><span></span><code>Microscope_name Magnification nm/px delta(°)
</code></pre></div>
<p>The <span class="arithmatex"><span class="MathJax_Preview">\delta</span><script type="math/tex">\delta</script></span> angle is the angle between the <span class="arithmatex"><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span> axis and the <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>-tilt axis. It can also be entered directly in the <code>image-alpha tilt</code> box.
When calibrated, the <code>Magnification</code> field can be filled. Note that magnification entered are multiplied by 1000.</p>
<h3 id="getting-data">Getting data<a class="headerlink" href="#getting-data" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Select the holder configuration</p>
</li>
<li>
<p>Open an image taken at a given <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>, <span class="arithmatex"><span class="MathJax_Preview">\beta</span><script type="math/tex">\beta</script></span>, <span class="arithmatex"><span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script></span> angles. Anticlockwise rotation can be indicated in the <code>AC</code> box. Make sure that the file name does not contain non-ASCII character.</p>
</li>
<li>
<p>Select the corresponding magnification for a given microscope setting</p>
</li>
<li>
<p>On the image, define the apparent trace direction by clicking on two points. Click a third point on the second trace (from a reference point if the traces are not parallel). Zoom in the image if necessary. The view and points can be reset using the two corresponding buttons. Press <code>ctrl+w</code> to remove the last point. </p>
</li>
<li>
<p><code>Add data</code> to the list. In the data box below appears <code>width, eta angle, alpha, beta, theta</code></p>
</li>
<li>
<p>Repeat the operation to get at least 3 conditions but 5-6 will improve accuracy. Select the lines used for the analysis</p>
</li>
<li>
<p>Press the <code>Get normal/direction</code> to get the plane normal. The results appear as:</p>
</li>
</ul>
<div class="highlight"><pre><span></span><code>Plane normal
x, y, z (or h,k,l if using the lattice coordinates)
Trace 
xt,yt,zt
Error on trace direction (°)
value
Error on plane normal (°)
value
Plane width
d in px or nm if calibrated
Error on plane width
value in px or nm
Estimated thickness
value +/- in  px or nm
</code></pre></div>
<p><img alt="" src="../images/interface-determination.png" /></p>
<div class="admonition info">
<p class="admonition-title">Results accuracy</p>
<p>Errors are computed using the <em>bootstrap method</em>. Starting from the set of data <span class="arithmatex"><span class="MathJax_Preview">(\vec{b}_{ei}, \eta_i)</span><script type="math/tex">(\vec{b}_{ei}, \eta_i)</script></span> or  <span class="arithmatex"><span class="MathJax_Preview">(\vec{b}_{ei}, w_i)</span><script type="math/tex">(\vec{b}_{ei}, w_i)</script></span>, to estimate the trace direction and normal, respectively, the data sets were resampled and estimated traces and normals were determined using the equation above. The 95% confidence interval was calculated from the 92th percentile of deviation of the trace and normal. This indicates that the normal should stay in a cone centered around <span class="arithmatex"><span class="MathJax_Preview">\vec{n}</span><script type="math/tex">\vec{n}</script></span> with a deviation of <span class="arithmatex"><span class="MathJax_Preview">\Delta\theta=\widehat{(\vec{n},\vec{n}'_{0.95})}</span><script type="math/tex">\Delta\theta=\widehat{(\vec{n},\vec{n}'_{0.95})}</script></span>. </p>
<p>The same procedure is carried out also in case of the measurement of  direction which leads to <span class="arithmatex"><span class="MathJax_Preview">\Delta\theta=\widehat{(\vec{l},\vec{l}'_{0.95})}</span><script type="math/tex">\Delta\theta=\widehat{(\vec{l},\vec{l}'_{0.95})}</script></span>. </p>
<p>Note that for some configurations, the confidence interval may be excessively large due to spurious resampling. Adding multiple data, ie. several measurements will prevent from this effect.</p>
<p>The sample thickness can be estimated from <sup id="fnref:thickness"><a class="footnote-ref" href="#fn:thickness">1</a></sup>:</p>
<div class="arithmatex">
<div class="MathJax_Preview">
t=d\sqrt{1-(\vec{n}\cdot\vec{s})^2}=d\vec{l}\cdot\vec{s}
</div>
<script type="math/tex; mode=display">
t=d\sqrt{1-(\vec{n}\cdot\vec{s})^2}=d\vec{l}\cdot\vec{s}
</script>
</div>
<p><span class="arithmatex"><span class="MathJax_Preview">\vec{s}</span><script type="math/tex">\vec{s}</script></span> being the foil normal. It is estimated in the results by considering that the foil normal is along <span class="arithmatex"><span class="MathJax_Preview">z_M</span><script type="math/tex">z_M</script></span>. The error on the estimation is complex because it depends both on the error on <span class="arithmatex"><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> and on the deviation of <span class="arithmatex"><span class="MathJax_Preview">\vec{n}</span><script type="math/tex">\vec{n}</script></span> or <span class="arithmatex"><span class="MathJax_Preview">\vec{l}</span><script type="math/tex">\vec{l}</script></span>. The two contributions can be approximately estimated to provide an error on the thickness.</p>
</div>
<p><img alt="" src="../images/interface-stereo.png" /></p>
<blockquote>
<p>Example of interface determination from a set of images (see <a href="https://github.com/mompiou/pycotem/tree/master/test/interface">here</a>). Cones around <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> and <span class="arithmatex"><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span> (normal and trace) corresponds to the 92% confidence interval.</p>
</blockquote>
<h3 id="drawing">Drawing<a class="headerlink" href="#drawing" title="Permanent link">&para;</a></h3>
<p>Drawing interface projection can be done using the <code>Draw</code> menu.</p>
<ul>
<li>
<p>Enter crystal thickness. Use the value given in the result box.</p>
</li>
<li>
<p>Surface normal can be indicated if known by ticking the <code>surf</code> box. Otherwise the surface is chosen as the plane normal to beam direction at zero tilt, which is usually a good approximation. Surface normal can be determined by the method shown here if two interface traces are present.</p>
</li>
<li>
<p>Enter the plane. Direction can be plotted if the <code>dir.</code> box is ticked.</p>
</li>
<li>
<p>A label can be displayed when the <code>label</code> box is ticked.</p>
</li>
<li>
<p>If the crystal is hexagonal, tick the <code>hexa</code> box to get the correct 4 indices for directions (the third indices is omitted)</p>
</li>
<li>
<p>Click on one trace. Don't forget to fill the tilt angles and microscope settings.</p>
</li>
<li>
<p>Press <code>OK</code> to plot the two apparent traces at the clicked point.</p>
</li>
<li>
<p>Press <code>ctrl+w</code> while in the draw window to remove the last plot.</p>
</li>
</ul>
<p><img alt="" src="../images/interface-draw.png" /></p>
<ul>
<li>
<p>The same procedure can be applied to determined and draw directions. The <code>direction</code> box should then be checked.</p>
</li>
<li>
<p>To reverse the drawing direction checked the <code>inv</code> button.</p>
</li>
</ul>
<p><img alt="" src="../images/interface-draw-dir.png" /></p>
<h3 id="measuring">Measuring<a class="headerlink" href="#measuring" title="Permanent link">&para;</a></h3>
<p>If two points are defined on the image, if the <code>measure</code> box is ticked, and if a plane is indicated, a result field appears in the dialog window.</p>
<p>It indicates:</p>
<ul>
<li>
<p>the distance measured in the plane (in nm if calibrated)</p>
</li>
<li>
<p>the direction in the plane</p>
</li>
<li>
<p>the maximum length in the direction, according to the sample thickness</p>
</li>
<li>
<p>the measure projected length (in nm)</p>
</li>
</ul>
<p><img alt="" src="../images/interface-measure.png" /></p>
<p>If the <code>proj. image</code> is checked, a stretched image is displayed. It corresponds to the image in the indicated plane. It allows to make directly measurement in this image without perspective effects. A <code>scale</code> of a given length can be added.  In the <code>draw window</code> is also indicated a rotation and stretch coefficient.</p>
<p><img alt="" src="../images/interface-stretched.png" /></p>
<h2 id="importexport-data">Import/Export data<a class="headerlink" href="#importexport-data" title="Permanent link">&para;</a></h2>
<p>Using the <code>Data</code> menu, data can be imported and results exported. 
Data sets are provided in a <code>.txt</code> file using the following scheme</p>
<div class="highlight"><pre><span></span><code># Interface data file 
# Euler angles 
phi1,phi, phi2 (may be left blank)
# Data for a  plane/direction
w_1(or l_1), eta_1,alpha_1,beta_1,theta_1
...
w_N(or l_N), eta_N,alpha_N,beta_N,theta_N
</code></pre></div>
<p>Exporting data will write in a <code>.txt</code> file,  adding to the above datasets. For plane:</p>
<div class="highlight"><pre><span></span><code># Results 
# Plane normal
# n_1,n_2, n_3 
# Trace
# t_1,t_2,t_3
# Error on trace direction (deg)
# ang
# Error on plane normal (deg)
# ang
# Plane width
# d
# Error on plane width
# dd
# Estimated thickness
# t
</code></pre></div>
<p>for directions:</p>
<p><div class="highlight"><pre><span></span><code># Results 
# Direction
# d1,d2,d3
# Error on trace direction (deg)
# ang
# Direction length
# l
# Error on direction width
# dl
# Estimated thickness
# t
</code></pre></div>
The two files can be combined in one as <code>#</code> sign will not be read during import.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:thickness">
<p>i.e. given a plane apparent width <span class="arithmatex"><span class="MathJax_Preview">t=w \large| \frac{\sin(\vec{b}_e,\vec{t}) \sin(\vec{n},\vec{s})}{\cos(\vec{n},\vec{b}_e)}\large|</span><script type="math/tex">t=w \large| \frac{\sin(\vec{b}_e,\vec{t}) \sin(\vec{n},\vec{s})}{\cos(\vec{n},\vec{b}_e)}\large|</script></span> or given a projected length <span class="arithmatex"><span class="MathJax_Preview">t=l \large|\frac{\cos (\vec{l},\vec{s})}{\cos(\vec{l_p},\vec{l})} \large|</span><script type="math/tex">t=l \large|\frac{\cos (\vec{l},\vec{s})}{\cos(\vec{l_p},\vec{l})} \large|</script></span>&#160;<a class="footnote-backref" href="#fnref:thickness" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
<!--  -->
<!--    <nav class="md-footer__inner md-grid" aria-label="Footer">-->
<!--      -->
<!--        -->
<!--        <a href="../stereoproj/" class="md-footer__link md-footer__link--prev" aria-label="Previous: StereoProj" rel="prev">-->
<!--          <div class="md-footer__button md-icon">-->
<!--            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>-->
<!--          </div>-->
<!--          <div class="md-footer__title">-->
<!--            <div class="md-ellipsis">-->
<!--              <span class="md-footer__direction">-->
<!--                Previous-->
<!--              </span>-->
<!--              StereoProj-->
<!--            </div>-->
<!--          </div>-->
<!--        </a>-->
<!--      -->
<!--      -->
<!--        -->
<!--        <a href="../misorientation/" class="md-footer__link md-footer__link--next" aria-label="Next: Misorientation" rel="next">-->
<!--          <div class="md-footer__title">-->
<!--            <div class="md-ellipsis">-->
<!--              <span class="md-footer__direction">-->
<!--                Next-->
<!--              </span>-->
<!--              Misorientation-->
<!--            </div>-->
<!--          </div>-->
<!--          <div class="md-footer__button md-icon">-->
<!--            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>-->
<!--          </div>-->
<!--        </a>-->
<!--      -->
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Contact  &nbsp <A HREF="mailto:mompiou@cemes.fr"><img src="https://mompiou.github.io/pycotem/images/envelope.png"  ></A>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.01824240.min.js"}</script>
    
    
      <script src="../assets/javascripts/bundle.e0abf5b0.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>