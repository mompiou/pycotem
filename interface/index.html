



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Interface - pycotem</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="#7e57c2">
      
    
    
      <script src="../assets/javascripts/modernizr.74668098.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Asap:300,400,400i,700|&display=fallback">
        <style>body,input{font-family:"Asap","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-purple" data-md-color-accent="deep-purple">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#introduction" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="pycotem" class="md-header-nav__button md-logo">
          
            <img src="../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                pycotem
              </span>
              <span class="md-header-nav__topic">
                Interface
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/mompiou/pycotem/" title="Go to repository" class="md-source" >
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      mompiou/pycotem
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../images/logo.png" width="26" height="51">
      
    </span>
   
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/mompiou/pycotem/" title="Go to repository" class="md-source" >
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      mompiou/pycotem
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../diffraction/" title="Diffraction" class="md-nav__link">
      Diffraction
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../kikuchi/" title="Kikuchi" class="md-nav__link">
      Kikuchi
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../stereoproj/" title="StereoProj" class="md-nav__link">
      StereoProj
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
<!--    -->
<!--    -->
<!--      <label class="md-nav__link md-nav__link--active" for="__toc">-->
<!--        Interface-->
<!--      </label>-->
<!--    -->
    <a href="./" title="Interface" class="md-nav__link md-nav__link--active">
      Interface
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#line-determination" title="Line determination" class="md-nav__link">
    Line determination
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interface" title="Interface" class="md-nav__link">
    Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure" title="Procedure" class="md-nav__link">
    Procedure
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings" title="Settings" class="md-nav__link">
    Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-data" title="Getting data" class="md-nav__link">
    Getting data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drawing" title="Drawing" class="md-nav__link">
    Drawing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importexport-data" title="Import/Export data" class="md-nav__link">
    Import/Export data
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../misorientation/" title="Misorientation" class="md-nav__link">
      Misorientation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../crystal/" title="Crystal" class="md-nav__link">
      Crystal
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../ressources/" title="Further ressources" class="md-nav__link">
      Further ressources
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../contribute/" title="About" class="md-nav__link">
      About
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" title="Introduction" class="md-nav__link">
    Introduction
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#line-determination" title="Line determination" class="md-nav__link">
    Line determination
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interface" title="Interface" class="md-nav__link">
    Interface
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#procedure" title="Procedure" class="md-nav__link">
    Procedure
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#settings" title="Settings" class="md-nav__link">
    Settings
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-data" title="Getting data" class="md-nav__link">
    Getting data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#drawing" title="Drawing" class="md-nav__link">
    Drawing
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#importexport-data" title="Import/Export data" class="md-nav__link">
    Import/Export data
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/mompiou/pycotem/edit/master/docs/interface.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Interface</h1>
                
                <p><code>interface</code> allows to determine interface normal or direction from a set of images.</p>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>Determining an interface plane can be performed using a series of TEM images (usually in Bright Field) acquired during a tilting series. Here we show how to get a quantitative assessment of the interface normal.</p>
<p>In TEM, a plane interface of normal <span><span class="MathJax_Preview">\vec{n}</span><script type="math/tex">\vec{n}</script></span> appear as a projection in the viewing screen. For a given orientation determined by the beam direction <span><span class="MathJax_Preview">\vec{b}_e</span><script type="math/tex">\vec{b}_e</script></span> in the sample reference frame (noted with the subscript <span><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span>), the interface plane is fully described by the direction of the projected traces <span><span class="MathJax_Preview">\vec{t}_p</span><script type="math/tex">\vec{t}_p</script></span> that correspond to the intersection between the foil surface <span><span class="MathJax_Preview">\vec{s}</span><script type="math/tex">\vec{s}</script></span> and the plane. In the projected plane coordinates (noted with <span><span class="MathJax_Preview">P</span><script type="math/tex">P</script></span>), the direction of the trace can be characterized by the azimuth angle <span><span class="MathJax_Preview">\eta</span><script type="math/tex">\eta</script></span> with the <span><span class="MathJax_Preview">y_P</span><script type="math/tex">y_P</script></span> direction. Note that because of the electron optics, the projected plane frame can be rotated with respect to the holder coordinate system (noted with <span><span class="MathJax_Preview">H</span><script type="math/tex">H</script></span>) along <span><span class="MathJax_Preview">z_P=z_H</span><script type="math/tex">z_P=z_H</script></span> (see this <a href="../stereoproj/#coordinate-systems">section</a>, for the definition of the holder coordinate system). </p>
<p>If the two surfaces are parallel the two projected traces are also parallel (fig. a). Thus, the width <span><span class="MathJax_Preview">w</span><script type="math/tex">w</script></span> between the two traces can be also measured. These data constitute the set <span><span class="MathJax_Preview">(\vec{b}_e, \eta ,w)</span><script type="math/tex">(\vec{b}_e, \eta ,w)</script></span>. If the surfaces are not parallel, the approach described below still works if a specific point <span><span class="MathJax_Preview">C</span><script type="math/tex">C</script></span> (projected on <span><span class="MathJax_Preview">H</span><script type="math/tex">H</script></span>) can be tracked (fig. b).</p>
<p><img alt="" src="../images/interface-schema.png" /></p>
<p>It can be shown that the apparent width <span><span class="MathJax_Preview">w</span><script type="math/tex">w</script></span> is given by:</p>
<div>
<div class="MathJax_Preview">
w= \frac{ \lvert d\vec{n} \cdot \vec{b}_e \rvert}{\sqrt{ 1- (\vec{b}_e \cdot \vec{t})^2}}
</div>
<script type="math/tex; mode=display">
w= \frac{ \lvert d\vec{n} \cdot \vec{b}_e \rvert}{\sqrt{ 1- (\vec{b}_e \cdot \vec{t})^2}}
</script>
</div>
<p>The unit normal vector <span><span class="MathJax_Preview">\vec{n}</span><script type="math/tex">\vec{n}</script></span> can be estimated following the two steps procedure:</p>
<ul>
<li>first solve <span><span class="MathJax_Preview">\vec{t}</span><script type="math/tex">\vec{t}</script></span> following the <span><span class="MathJax_Preview">m</span><script type="math/tex">m</script></span> equations:</li>
</ul>
<div>
<div class="MathJax_Preview">
[\vec{b}_{e1} \times \vec{t}_{p1}, ..., \vec{b}_{em} \times \vec{t}_{pm} ]^T \cdot \vec{t} =0
</div>
<script type="math/tex; mode=display">
[\vec{b}_{e1} \times \vec{t}_{p1}, ..., \vec{b}_{em} \times \vec{t}_{pm} ]^T \cdot \vec{t} =0
</script>
</div>
<ul>
<li>then solve :</li>
</ul>
<div>
<div class="MathJax_Preview">
\left[\begin{array}{c}
\vec{b}_{e1}^\mathrm{T} \\[2mm]
\vec{b}_{e2}^\mathrm{T} \\[2mm]
...\\
\vec{b}_{em}^\mathrm{T} \\[2mm]
\vec{t}^\mathrm{T}
\end{array}\right]
(d \vec{n})
=\left[\begin{array}{c} 
\mathrm{sgn}(1) w_1\sqrt{1- \left(\vec{b}_{e1} \cdot \vec{t} \right)^2}\\[0.5mm]
\mathrm{sgn}(2)w_2\sqrt{1- \left(\vec{b}_{e2} \cdot \vec{t} \right)^2}\\[0.5mm]
...\\
\mathrm{sgn}(m)w_m\sqrt{1- \left(\vec{b}_{em} \cdot \vec{t} \right)^2}\\[0.5mm]
0
\end{array}
\right]
</div>
<script type="math/tex; mode=display">
\left[\begin{array}{c}
\vec{b}_{e1}^\mathrm{T} \\[2mm]
\vec{b}_{e2}^\mathrm{T} \\[2mm]
...\\
\vec{b}_{em}^\mathrm{T} \\[2mm]
\vec{t}^\mathrm{T}
\end{array}\right]
(d \vec{n})
=\left[\begin{array}{c} 
\mathrm{sgn}(1) w_1\sqrt{1- \left(\vec{b}_{e1} \cdot \vec{t} \right)^2}\\[0.5mm]
\mathrm{sgn}(2)w_2\sqrt{1- \left(\vec{b}_{e2} \cdot \vec{t} \right)^2}\\[0.5mm]
...\\
\mathrm{sgn}(m)w_m\sqrt{1- \left(\vec{b}_{em} \cdot \vec{t} \right)^2}\\[0.5mm]
0
\end{array}
\right]
</script>
</div>
<p>the <span><span class="MathJax_Preview">\mathrm{sgn}(i)</span><script type="math/tex">\mathrm{sgn}(i)</script></span> here denotes that although the measure width is always positive, the dot product <span><span class="MathJax_Preview">\vec{b}_{ei} \cdot \vec{n}</span><script type="math/tex">\vec{b}_{ei} \cdot \vec{n}</script></span> can be negative.</p>
<p>The equation can be solved using the least square method, by varying <span><span class="MathJax_Preview">\mathrm{sgn}(i)</span><script type="math/tex">\mathrm{sgn}(i)</script></span>. The solution with the smallest residual is considered to be the correct one.</p>
<p>The inputs data used are for a double tilt holder using the convention described in <a href="../stereoproj/">stereoproj</a> derived from the position of the beam direction and apparent trace direction in the sample coordinates:</p>
<div>
<div class="MathJax_Preview">
\vec{b}_{ei}=R_x(-\beta_i)R_y(-\alpha_i)[0,0,1]^T \\
\vec{t}_{pi}=R_x(-\beta_i)R_y(-\alpha_i)R_z(\delta)R_z(\eta)[0,1,0]^T
</div>
<script type="math/tex; mode=display">
\vec{b}_{ei}=R_x(-\beta_i)R_y(-\alpha_i)[0,0,1]^T \\
\vec{t}_{pi}=R_x(-\beta_i)R_y(-\alpha_i)R_z(\delta)R_z(\eta)[0,1,0]^T
</script>
</div>
<h3 id="line-determination">Line determination<a class="headerlink" href="#line-determination" title="Permanent link">&para;</a></h3>
<p>The same approach can be used to determine a linear feature <span><span class="MathJax_Preview">\vec{l}</span><script type="math/tex">\vec{l}</script></span> using the data sets <span><span class="MathJax_Preview">(\vec{b}_{ei}, \vec{l}_{pi}, l_i)</span><script type="math/tex">(\vec{b}_{ei}, \vec{l}_{pi}, l_i)</script></span> by solving:</p>
<div>
<div class="MathJax_Preview">
[\vec{b}_{ei} \times \vec{l}_{pi}, \vec{b}_{ei}]^T d\vec{l} =[0, l_i]^T
</div>
<script type="math/tex; mode=display">
[\vec{b}_{ei} \times \vec{l}_{pi}, \vec{b}_{ei}]^T d\vec{l} =[0, l_i]^T
</script>
</div>
<h2 id="interface">Interface<a class="headerlink" href="#interface" title="Permanent link">&para;</a></h2>
<p>The interface is composed of  a top bar menu, a plotting area to display images and a setting/results panel.</p>
<p><img alt="" src="../images/interface-interface.png" /></p>
<h2 id="procedure">Procedure<a class="headerlink" href="#procedure" title="Permanent link">&para;</a></h2>
<h3 id="settings">Settings<a class="headerlink" href="#settings" title="Permanent link">&para;</a></h3>
<p>The interface normal can be determined in the sample frame. If necessary it can be determined in the crystal frame if both the nature of crystal and its orientation are known. This requires to tick the <code>Use lattice coordinates</code> button.</p>
<p>Crystal structure can be imported from the <code>structure</code> menu or by filling the <span><span class="MathJax_Preview">a,b,c</span><script type="math/tex">a,b,c</script></span> and <span><span class="MathJax_Preview">\alpha,\beta,\gamma</span><script type="math/tex">\alpha,\beta,\gamma</script></span> fields. </p>
<p><strong>Microscope</strong> calibration need to be set to get correct scaling when the apparent widths <span><span class="MathJax_Preview">w</span><script type="math/tex">w</script></span> are measured. If the box is set to <code>uncalibrated</code> measured will be performed in pixels. Calibrations can be set in the <code>microscope.txt</code> file with the following scheme:</p>
<div class="codehilite"><pre><span></span>Microscope_name Magnification nm/px delta(°)
</pre></div>

<p>The <span><span class="MathJax_Preview">\delta</span><script type="math/tex">\delta</script></span> angle is the angle between the <span><span class="MathJax_Preview">y</span><script type="math/tex">y</script></span> axis and the <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>-tilt axis. It can also be entered directly in the <code>image-alpha tilt</code> box.
When calibrated, the <code>Magnification</code> field can be filled. Note that magnification entered are multiplied by 1000.</p>
<h3 id="getting-data">Getting data<a class="headerlink" href="#getting-data" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Select the holder configuration</p>
</li>
<li>
<p>Open an image taken at a given <span><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span>, <span><span class="MathJax_Preview">\beta</span><script type="math/tex">\beta</script></span>, <span><span class="MathJax_Preview">\theta</span><script type="math/tex">\theta</script></span> angles. Anticlockwise rotation can be indicated in the <code>AC</code> box. Make sure that the file name does not contain non-ASCII character.</p>
</li>
<li>
<p>Select the corresponding magnification for a given microscope setting</p>
</li>
<li>
<p>On the image, define the apparent trace direction by clicking on two points. Click a third point on the second trace (from a reference point if the traces are not parallel). Zoom in the image if necessary. The view and points can be reset using the two corresponding buttons </p>
</li>
<li>
<p><code>Add data</code> to the list. In the data box below appears <code>width, eta angle, alpha, beta, theta</code></p>
</li>
<li>
<p>Repeat the operation to get at least 3 conditions but 5-6 will improve accuracy. Select the lines used for the analysis</p>
</li>
<li>
<p>Press the <code>Get normal/direction</code> to get the plane normal. The results appear as:</p>
</li>
</ul>
<div class="codehilite"><pre><span></span>Plane normal
x, y, z (or h,k,l if using the lattice coordinates)
Trace 
xt,yt,zt
Error on trace direction (°)
value
Error on plane normal (°)
value
Plane width
d in px or nm if calibrated
Error on plane width
value in px or nm
Estimated thickness
value +/- in  px or nm
</pre></div>

<p><img alt="" src="../images/interface-determination.png" /></p>
<div class="admonition info">
<p class="admonition-title">Results accuracy</p>
<p>Errors are computed using the <em>bootstrap method</em>. Starting from the set of data <span><span class="MathJax_Preview">(\vec{b}_{ei}, \eta_i)</span><script type="math/tex">(\vec{b}_{ei}, \eta_i)</script></span> or  <span><span class="MathJax_Preview">(\vec{b}_{ei}, w_i)</span><script type="math/tex">(\vec{b}_{ei}, w_i)</script></span>, to estimate the trace direction and normal, respectively, the data sets were resampled and estimated traces and normals were determined using the equation above. The 95% confidence interval was calculated from the 95<sup>th</sup> percentile of deviation of the trace and normal. This indicates that the normal should stay in a cone centered around <span><span class="MathJax_Preview">\vec{n}</span><script type="math/tex">\vec{n}</script></span> with a deviation of <span><span class="MathJax_Preview">\Delta\theta=\widehat{(\vec{n},\vec{n}'_{0.95})}</span><script type="math/tex">\Delta\theta=\widehat{(\vec{n},\vec{n}'_{0.95})}</script></span>. </p>
<p>The same procedure is carried out also in case of the measurement of  direction which leads to <span><span class="MathJax_Preview">\Delta\theta=\widehat{(\vec{l},\vec{l}'_{0.95})}</span><script type="math/tex">\Delta\theta=\widehat{(\vec{l},\vec{l}'_{0.95})}</script></span>. </p>
<p>Note that for some configurations, the confidence interval may be excessively large due to spurious resampling. Adding multiple data, ie. several measurements will prevent from this effect.</p>
<p>The sample thickness can be estimated from:</p>
<div>
<div class="MathJax_Preview">
t=d\sqrt{1-(\vec{n}\cdot\vec{s})^2}=d\vec{l}\cdot\vec{s}
</div>
<script type="math/tex; mode=display">
t=d\sqrt{1-(\vec{n}\cdot\vec{s})^2}=d\vec{l}\cdot\vec{s}
</script>
</div>
<p><span><span class="MathJax_Preview">\vec{s}</span><script type="math/tex">\vec{s}</script></span> being the foil normal. It is estimated in the results by considering that the foil normal is along <span><span class="MathJax_Preview">z_M</span><script type="math/tex">z_M</script></span>. The error on the estimation is complex because it depends both on the error on <span><span class="MathJax_Preview">d</span><script type="math/tex">d</script></span> and on the deviation of <span><span class="MathJax_Preview">\vec{n}</span><script type="math/tex">\vec{n}</script></span> or <span><span class="MathJax_Preview">\vec{l}</span><script type="math/tex">\vec{l}</script></span>. The two contributions can be approximately estimated to provide an error on the thickness.</p>
</div>
<p><img alt="" src="../images/interface-stereo.png" /></p>
<blockquote>
<p>Example of interface determination from a set of images (see <a href="https://github.com/mompiou/pycotem/tree/master/test/interface">here</a>). Cones around <span><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> and <span><span class="MathJax_Preview">t</span><script type="math/tex">t</script></span> (normal and trace) corresponds to the 95% confidence interval.</p>
</blockquote>
<h3 id="drawing">Drawing<a class="headerlink" href="#drawing" title="Permanent link">&para;</a></h3>
<p>Drawing interface projection can be done using the <code>Draw</code> menu.</p>
<ul>
<li>
<p>Enter crystal thickness. Use the value given in the result box.</p>
</li>
<li>
<p>Surface normal can be indicated if known by ticking the <code>surf</code> box. Otherwise the surface is chosen as the plane normal to beam direction at zero tilt, which is usually a good approximation. Surface normal can be determined by the method shown here if two interface traces are present.</p>
</li>
<li>
<p>Enter the plane. Direction can be plotted if the <code>dir.</code> box is ticked.</p>
</li>
<li>
<p>A label can be displayed when the <code>label</code> box is ticked.</p>
</li>
<li>
<p>Click on one trace. Don't forget to fill the tilt angles and microscope settings.</p>
</li>
<li>
<p>Press <code>OK</code> to plot the two apparent traces at the clicked point.</p>
</li>
</ul>
<p><img alt="" src="../images/interface-draw.png" /></p>
<p>The same procedure can be applied to determined and draw directions. The <code>direction</code> box should then be checked.</p>
<p><img alt="" src="../images/interface-draw-dir.png" /></p>
<h2 id="importexport-data">Import/Export data<a class="headerlink" href="#importexport-data" title="Permanent link">&para;</a></h2>
<p>Using the <code>Data</code> menu, data can be imported and results exported. 
Data sets are provided in a <code>.txt</code> file using the following scheme</p>
<div class="codehilite"><pre><span></span># Interface data file 
# Euler angles 
phi1,phi, phi2 (may be left blank)
# Data for a  plane/direction
w_1(or l_1), eta_1,alpha_1,beta_1,theta_1
...
w_N(or l_N), eta_N,alpha_N,beta_N,theta_N
</pre></div>

<p>Exporting data will write in a <code>.txt</code> file,  adding to the above datasets. For plane:</p>
<div class="codehilite"><pre><span></span># Results 
# Plane normal
# n_1,n_2, n_3 
# Trace
# t_1,t_2,t_3
# Error on trace direction (deg)
# ang
# Error on plane normal (deg)
# ang
# Plane width
# d
# Error on plane width
# dd
# Estimated thickness
# t
</pre></div>

<p>for directions:</p>
<p><div class="codehilite"><pre><span></span># Results 
# Direction
# d1,d2,d3
# Error on trace direction (deg)
# ang
# Direction length
# l
# Error on direction width
# dl
# Estimated thickness
# t
</pre></div>
The two files can be combined in one as <code>#</code> sign will not be read during import.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Contact  &nbsp <A HREF="mailto:mompiou@cemes.fr"><img src="https://mompiou.github.io/pycotem/images/envelope.png"  ></A>
          </div>
        
        powered by
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>